


<h2>Task 1. Introduction</h2>


<h2>Task 2. Overview of CSRF Attack</h2>

<h2>Task 3. Types of CSRF Attack</h2>


<h2>Task 4. Basic CSRF - Hidden Link/Image Exploitation</h2>

<br>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 4.1. <em>What is the flag value after a successful transfer from Josh's account?</em><br><a id='4.1'></a>
>> <strong><code>THM{SUCCESSFUL_ATTACK}</code></strong><br>
<p><br></p>


![image](https://github.com/user-attachments/assets/2c2f736b-5a8e-4916-8c8b-8d5d5dc20a57)


<br>
<br>

![image](https://github.com/user-attachments/assets/a3946075-4f08-4eea-aa45-0bef31f717dd)

<p>I accessed <code>http://mybank.thm:8080</code> in FireFox.<br>
Then used <code>Inspect</code>, after clicked in <code>Storage</code> and added <code>isBanned</code> as <em>Cookie Name</em> and the same <em>Cookie Value</em> present in the <code>Online Banking</code> page in <code>Chrome</code>.</p>

<br>

<p>After refreshing the webpage in <code>FireFox</code> I got .... ü•∞ .... code>Client Login</code>.</p>

![image](https://github.com/user-attachments/assets/375ade87-0bd3-43b3-aa8d-d70733cbc1d5)


<p>I used the credentials provided: Username <code>GB82MYBANK5698</code> and Password <code>GB82MYBANK5698</code>.</p>

![image](https://github.com/user-attachments/assets/9a4d24fc-a817-4174-9901-f4089acaecb7)

<p>Now we have User Account opened in two web browsers. üòµ</p>

![image](https://github.com/user-attachments/assets/0e1a30bf-cc21-4395-9424-096ac947a5cc)


<p>Let¬¥s try to make a <code>Quick Transfer</code> of $1,401. üí∏</code></p>

![image](https://github.com/user-attachments/assets/a4e15a62-cf6d-40ec-be0c-aded7a9a2bd3)

<br>

![image](https://github.com/user-attachments/assets/760a5f75-ec81-4efd-9086-e715ca65be14)

<br>

<p>Holly Molly, it worked! ‚ö†Ô∏è</p>

![image](https://github.com/user-attachments/assets/8beba3e5-9367-4aab-968b-3d97a40527d6)

<p><code>Transfer successful! - <strong>Flag:<br>THM{SUCCESSFUL_ATTACK}</strong></code></p>

<br>

> 4.2. <em>What is the flag value once the CSRF attack is detected?</em><br><a id='4.2'></a>
>> <strong><code>THM{INVALID_CSRF_TOKEN}</code></strong><br>
<p><br></p>

<p>Together with <code>Quick Transfer</code> transaction completion there is some interesting information ...</p>

![image](https://github.com/user-attachments/assets/dbf35bbd-9a29-4f7d-bb0e-3f748376e6a0)

<br>

![image](https://github.com/user-attachments/assets/0c610ee9-2e68-4746-accc-6aa3500ba682)

<p><code>GET http://mybank.thm:8080/dashboard.php?to_account=Emengarda&amount=1401</code></p>

<p>My next step was going back to Google Chrome, accessing Mailbox, and clicking over the first message classified as <code>vulnerable</code>.</p>

![image](https://github.com/user-attachments/assets/94b3b1e2-d195-4909-a885-0c1fd9ba0044)

<br>

![image](https://github.com/user-attachments/assets/4cf68eaf-e965-422c-960d-872712838dd3)

<p>If we click on <code>Click Here to Redeem</code>, guess what happens?  Another successful transfer.</p>

![image](https://github.com/user-attachments/assets/5b914acd-e359-4f98-b38a-d6b4c6c3802f)

<p>If we select the secont e-mail and clicke on <code>Click Here to Redeem</code> ...</p>

![image](https://github.com/user-attachments/assets/a2f330a3-0b85-4414-9d36-870ea19632fa)

<p>We received a <code>Invalid CSRF Token Found - Flag:</code> ...</p>

![image](https://github.com/user-attachments/assets/815587e9-5a02-4750-a09e-006ed3ddf1ba)

<br>

> 4.3. <em>Does the hidden image exploitation <code>require</code> the <code>img</code> tag's <code>src</code> attribute to be linked toward a legitimate image file (yea/nay)?</em><br><a id='4.3'></a>
>> <strong><code>nay</code></strong><br>
<p><br></p>











