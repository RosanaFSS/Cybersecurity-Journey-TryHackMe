<h3> Welcome to the <em>TryHackMe ...</em></h3>
<h1>Jr Penetration Tester learning path> Network Security</h1>
<h2>Protocols and Servers</h2>
<p>Learn about common protocols such as HTTP, FTP, POP3, SMTP and IMAP, along with related insecurities.</p>
<p>October 24, 2024<br></p>

<div style="display: flex; justify-content: center; align-items: center;">
    <img src="https://github.com/user-attachments/assets/9040bc51-626e-4707-b507-4fcab030b87e" width="150px" height="150px"/>
</div>
<br>

![image](https://github.com/user-attachments/assets/669a2770-b728-4105-9527-af04ac07a8f3)


<p>Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m genuinely excited to join you on this adventure. It´s key part of my 26-day-streak in <a href="https://www.wicys.org/benefits/security-training-scholarship/">WiCyS SANS Security Training</a> Stage 2 Program. Let´s get started!!<br><br>
Access this TryHackMe Room clicking <a href="https://tryhackme.com/r/room/protocolsandservers">Protocols and Servers</a></p>

<h2>Task 1 - Introduction</h2>

<p>This room introduces the user to a few protocols commonly used, such as:<br>

<ul style="list-style-type:square">
    <li>HTTP</li>
    <li>FTP</li>
    <li>POP3</li>
    <li>SMTP</li>
    <li>IMAP</li>
</ul></p>
<p>Each task about each protocol will be designed to help us understand what happens on the low level and is usually hidden by an elegant GUI (Graphical User Interface). We will “talk” using the above protocols using a simple Telnet client to fully understand what your GUI client is doing under the hood. Our purpose is not to memorize the protocol commands but rather to get a closer look at the protocol while it is working.<br>

We also discuss some of the insecurities. In particular, we focus on passwords sent in cleartext.</p>

> 1.1 - <em>We suggest that you start the AttackBox and the virtual machine as you proceed to tackle the following tasks. You can connect to the different services over Telnet for better practice and learning experience.</em><br>
>> <strong>No answer needed</strong><br>
<p><br></p>

<h2>Task 2 - Telnet</h2>

<p>The Telnet protocol is an application layer protocol used to connect to a virtual terminal of another computer. Using Telnet, a user can log into another computer and access its terminal (console) to run programs, start batch processes, and perform system administration tasks remotely.<br>

Telnet protocol is relatively simple. When a user connects, they will be asked for a username and password. Upon correct authentication, the user will access the remote system’s terminal. Unfortunately, all this communication between the Telnet client and the Telnet server is not encrypted, making it an easy target for attackers.<br>

A Telnet server uses the Telnet protocol to listen for incoming connections on port 23. (Please note that the Telnet port is not open on the target VM.) Let’s consider the example shown below. A user is connecting to the telnetd, a Telnet server. The steps are as follows:<br>

<ol type="1. ">
  <li>First, he is asked to provide his login name (username). We can see the user entering <code>frank</code>.</li>
  <li>Then, he is asked for the password, <code>D2xc9CgD</code>. The password is not shown on the screen; however, we display it below for demonstration purposes.</li>
  <li>Once the system checks his login credentials, he is greeted with a welcome message.</li>
  <li>And the remote server grants him a command prompt, frank@bento:~$. The $ indicates that this is not a root terminal.</li>
</ol></p>

![image](https://github.com/user-attachments/assets/208d2ef1-60f0-4f0a-b8d1-2637300f3b09)

<p>Although Telnet gave us access to the remote system’s terminal in no time, it is not a reliable protocol for remote administration as all the data are sent in cleartext. In the figure below, we captured the traffic generated by Telnet, and it was so easy to find the password. The figure below shows the ASCII data exchanged between our computer and the remote system. The text in red is the text that we are sending to the remote system, while the text in blue is the text that the remote system is sending. Notice how the user name was sent back (echoed at us to display them in our terminal); however, the password was not. In other words, if someone is watching us type, they won’t be able to see the password characters on the screen.</p>

![image](https://github.com/user-attachments/assets/16701a4d-fc1a-4930-880c-a9cc4b80b78a)

<p>Telnet is no longer considered a secure option, especially that anyone capturing your network traffic will be able to discover your usernames and passwords, which would grant them access to the remote system. The secure alternative is SSH, which we present in the next room.</p>

> 2.1 - <em>To which port will the <code>telnet</code> command with the default parameters try to connect?</em><br>
>> <strong>23</strong><br>
<p><br></p>

<h2>Task 3 - Hypertext Transfer Protocol (HTTP)</h2>

<p>Hypertext Transfer Protocol (HTTP) is the protocol used to transfer web pages. Your web browser connects to the webserver and uses HTTP to request HTML pages and images among other files and submit forms and upload various files. Anytime you browse the World Wide Web (WWW), you are certainly using the HTTP protocol.<br>

The image below shows a client requesting the HTML page <code>index.html</code>, which the webserver provides. Then the client requests an image, <code>logo.jpg</code>, and the web server sends it.</p>

![image](https://github.com/user-attachments/assets/2eb07a64-4d7b-486d-a88d-8001e9c0cfd6)

<p>HTTP sends and receives data as cleartext (not encrypted); therefore, you can use a simple tool, such as Telnet (or Netcat), to communicate with a web server and act as a “web browser”. The key difference is that you need to input the HTTP-related commands instead of the web browser doing that for you.<br>

In the following example, we will see how we can request a page from a web server; moreover, we will discover the webserver version. To accomplish this, we will use the Telnet client. We chose it because Telnet is a simple protocol; furthermore, it uses cleartext for communication. We will use <code>telnet</code> instead of a web browser to request a file from the webserver. The steps will be as follows:

<ul style="list-style-type:square">
    <li>First, we connect to port 80 using <code>telnet 10.10.146.146 80</code>.</li>
    <li>Next, we need to type <code>GET /index.html HTTP/1.1</code> to retrieve the page <code>index.html</code> or <code>GET / HTTP/1.1</code> to retrieve the default page.</li>
    <li>Finally, you need to provide some value for the host like <coe>host: telnet</code> and press the Enter/Return key twice.</li>
</ul></p>

<p>In the console output below, we could recover the requested page along with a trove of information not usually displayed by the web browser. If the page we requested is not found, we get error 404.</p>

![image](https://github.com/user-attachments/assets/c04168be-54dc-478b-95b9-3372989fa18e)

<p>Of particular interest in the output above is that the user needs only to type a couple of commands to get the page they need: <code>GET /index.html HTTP/1.1</code> followed by <code>host: telnet</code>.<br>

We need an HTTP server (webserver) and an HTTP client (web browser) to use the HTTP protocol. The web server will “serve” a specific set of files to the requesting web browser.<br>

Three popular choices for HTTP servers are:</p>
<ul style="list-style-type:square">
    <li>Apache</li>
    <li>Internet Information Services (IIS)</li>
    <li>nginx</li>
</ul></p>

<p>Apache and Nginx are free and open-source software. However, IIS is closed source software and requires paying for a license.<br>

There are many web browsers available. At the time of writing, the most popular web browsers are:</p>

<ul style="list-style-type:square">
    <li>Chrome by Google</li>
    <li>Edge by Microsoft</li>
    <li>Firefox by Mozilla</li>
    <li>Safari by Apple.</li>
</ul></p>

<p>Web browsers are generally free to install and use; furthermore, tech giants battle for a higher market share for their browsers.</p>

> 3.1 - <em>Launch the attached VM. From the AttackBox terminal, connect using Telnet to <code>10.10.146.146 80</code> and retrieve the file <code>flag.thm</code>. What does it contain?</em><br>
>> <strong>THM{e3eb0a1df437f3f97a64aca5952c8ea0}</strong><br>

<pre><code>$ telnet 10.10.146.146 80
Trying 10.10.146.146...
Connected to 10.10.146.146.
Escape character is '^]'.
GET /flag.thm HTTP/1.1
host:telnet

HTTP/1.1 200 OK
Server: nginx/1.18.0 (Ubuntu)
Date: Thu, 24 Oct 2024 22:06:10 GMT
Content-Type: application/octet-stream
Content-Length: 39
Last-Modified: Wed, 15 Sep 2021 09:19:23 GMT
Connection: keep-alive
ETag: "6141ba9b-27"
Accept-Ranges: bytes

THM{e3eb0a1df437f3f97a64aca5952c8ea0}
</code></pre>

<h2>Task 4 - File Transfer Protocol (FTP)</h2>

<p>File Transfer Protocol (FTP) was developed to make the transfer of files between different computers with different systems efficient.<br>

FTP also sends and receives data as cleartext; therefore, we can use Telnet (or Netcat) to communicate with an FTP server and act as an FTP client. In the example below, we carried out the following steps:</p>

<ol type="1. ">
  <li>We connected to an FTP server using a Telnet client. Since FTP servers listen on port 21 by default, we had to specify to our Telnet client to attempt connection to port 21 instead of the default Telnet port.</li>
  <li>We needed to provide the username with the command <code>USER frank</code>.</li>
  <li>Then, we provided the password with the command <code>PASS D2xc9CgD</code>.</li>
  <li>Because we supplied the correct username and password, we got logged in.</li>
</ol></p>

Because we supplied the correct username and password, we got logged in.
<p>A command like <code>STAT</code> can provide some added information. The <code>SYST</code> command shows the System Type of the target (UNIX in this case). <code>PASV</code> switches the mode to passive. It is worth noting that there are two modes for FTP:</p>
<ul style="list-style-type:square">
    <li>Active: In the active mode, the data is sent over a separate channel originating from the FTP server’s port 20.</li>
    <li>Passive: In the passive mode, the data is sent over a separate channel originating from an FTP client’s port above port number 1023.</li>
</ul></p>

<p>The command <code>TYPE A</code> switches the file transfer mode to ASCII, while <code>TYPE I</code> switches the file transfer mode to binary. However, we cannot transfer a file using a simple client such as Telnet because FTP creates a separate connection for file transfer.</p>

![image](https://github.com/user-attachments/assets/17f3b301-a5eb-4c97-99a3-09a8147a3245)

<p>The image below shows how an actual file transfer would be conducted using FTP. To keep things simple in this figure, let’s only focus on the fact that the FTP client will initiate a connection to an FTP server, which listens on port 21 by default. All commands will be sent over the control channel. Once the client requests a file, another TCP connection will be established between them. (The details of establishing the data connection/channel is beyond the scope of this room.)</p>

![image](https://github.com/user-attachments/assets/8d649e59-529d-4eaa-aff6-ec2ea7f807c9)

<p>Considering the sophistication of the data transfer over FTP, let’s use an actual FTP client to download a text file. We only needed a small number of commands to retrieve the file. After logging in successfully, we get the FTP prompt, <code>ftp><code></code>, to execute various FTP commands. We used <code>ls</code> to list the files and learn the file name; then, we switched to <code>ascii</code> since it is a text file (not binary). Finally, <code>get FILENAME</code> made the client and server establish another channel for file transfer.</p>

![image](https://github.com/user-attachments/assets/27c76ae5-4a60-4fb1-912f-85572ee0a030)

<p>FTP servers and FTP clients use the FTP protocol. There are various FTP server software that you can select from if you want to host your FTP file server. Examples of FTP server software include:</p>
<ul style="list-style-type:square">
    <li>vsftpd</li>
    <li>ProFTPD</li>
    <li>uFTP</li>
</ul></p>
<p>For FTP clients, in addition to the console FTP client commonly found on Linux systems, you can use an FTP client with GUI such as FileZilla. Some web browsers also support FTP protocol.<br>

Because FTP sends the login credentials along with the commands and files in cleartext, FTP traffic can be an easy target for attackers.</p>

> 4.1 - <em>Using an FTP client, connect to the VM and try to recover the flag file. What is the flag?</em><br>
> Username:frank<br>
> Password: D2xc9CgD<br>
>> <strong>THM{e3eb0a1df437f3f97a64aca5952c8ea0}</strong><br>

<pre><code>$ telnet 10.10.146.146 80


</code></pre>

<h2>Task 5 - Simple Mail Transfer Protocol (SMTP)</h2>

<h2>Task 6 - Post Office Procol 3 (POP3)</h2>

<h2>Task 7 - Internet Message Access Protocol (IMAP)</h2>

<h2>Room Complete</h2>
