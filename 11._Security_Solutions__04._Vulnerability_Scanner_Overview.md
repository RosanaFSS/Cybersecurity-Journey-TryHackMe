![image](https://github.com/user-attachments/assets/b4d5cd93-5c9b-4c46-833d-bdc2702c7cdd)<h3> Welcome to the <em>TryHackMe ...</em></h3>
<h1>Cyber Security 101 learning path > Security Solutions ></h1>
<h2>Vulnerability Scanner Overview</h2>
<p>Learn about vulnerability scanners and how they work in a practical scenario.</p>
<p>October 22, 2024<br></p>

<center>
<img src="https://github.com/user-attachments/assets/2944e3ed-13c2-47e7-b86f-936ca19e8380"
height="200" width="200">
</center>

![image](https://github.com/user-attachments/assets/15c3cf99-ed03-4cc3-8ca1-e7da97e7cc67)



<p>Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m genuinely excited to join you on this adventure. It´s key part of my 169-day-streak. Let´s get started!!<br><br>
Access this TryHackMe Room clicking <a href="https://tryhackme.com/r/room/vulnerabilityscanneroverview">Vulnerability Scanner Overview</a></p>

<h2>Task 1 - What are Vulnerabilities?</h2>
<p>Imagine you are living in a small, lovely house. One day, you notice that your roof has many small holes. If not treated, these small holes can cause significant problems. During rain, water can come through these leaks and damage your furniture. Dust particles and insects can enter the house through these tiny holes. These small holes are a weakness in your home that can lead to significant problems in the future if not addressed timely. These weaknesses are known as <strong><em>Vulberabilities</em></strong>. You start repairing the roof to fix this problem and keep your home safe. This process of fixing the vulnerabilities is known as <strong><em>Patching</em></strong>.<br><br>

Digital devices also have vulnerabilities inside their software or hardware. These are the weaknesses in the software programs or hardware that an attacker can leverage to compromise the digital device. These vulnerabilities may sound normal to you, like the small holes in the roof of a house that can be repaired anytime. However, the vulnerabilities in digital devices can lead to massive damage if not noticed on time. Hackers are always searching for these weaknesses as they make their way to your systems or networks by exploiting them. The interesting thing about digital device vulnerabilities is that you cannot notice them as easily as the holes in the roof until you dedicate yourself to hunting them down. After hunting these vulnerabilities down, the process of patching starts, where fixes are applied to protect the vulnerabilities.<br><br>

This room is about learning how to hunt these vulnerabilities in digital devices. We will study some of the available tools to automate this hunting and leverage one of the tools to demonstrate how it’s done practically.<br></p>
<h3>Learning Objectives</h3>
 <ul style="list-style-type:square">
    <li>Making a custom rule in Snort IDS</li>
    <li>Making a custom rule in Snort IDS</li>
    <li>Making a custom rule in Snort IDS</li>
    <li>Practical exercise.</li>
</ul><br></p>

> 1.1 - <em>What is the process of fixing the vulnerabilities called?</em><br>
>> <strong>Patching</strong><br>
<p><br></p>

<h2>Task 2 - Vulnerability Scanning</h2>
<p>Vulnerability scanning is the inspection of digital systems to find weaknesses. Organizations carry critical information in their digital infrastructure. They must regularly scan their systems and networks for vulnerabilities, as attackers can leverage these vulnerabilities to compromise their digital infrastructure, resulting in a considerable loss. Vulnerability scanning is also an important compliance requirement of many regulatory bodies. Some security standards advise performing vulnerability scanning quarterly, while some advise performing it once a year.<br><br>

We saw how important it is to conduct vulnerability scans in your digital landscape regularly; however, manually looking for these weaknesses can be very hectic and miss some major ones. The bigger the network is, the slower the process of manual vulnerability scanning would be. This is no longer an issue as some efficient vulnerability scanners that perform automated vulnerability scanning are available in the market. This automated vulnerability scanning has made life much easier. You only need to install the tool and give it an IP address for a host or a network range for a network; it will start checking vulnerabilities and give you an easy-to-read report with the details of the vulnerabilities found.<br><br>

After identifying vulnerabilities, organizations fix them by making changes to a software program or system. These changes are referred to as <strong><em>Patches</em></strong>.

Vulnerability scans can be categorized into many types; however, the major categorization of these scans are explained below:.</p>
<p></p>

<h3><strong>Authenticated vs. Unauthenticated Scans</strong></h3>
<p>Authenticated scans require the subject host's credentials and are more detailed than unauthenticated scans. These types of scans are helpful for discovering the threat surface within the host. However, unauthenticated scans are conducted without providing any credentials of the subject host. These scans help identify the threat surface from outside the host.<br></p>

| Authenticate Scans                             | Unauthenticated Scans                          |
| :--------------------------------------------: | :--------------------------------------------: | 
| The credentials of the subject host must be provided to the vulnerability scanner. | The credentials of the subject host must be provided to the vulnerability scanner. | 
| The credentials of the subject host must be provided to the vulnerability scanner. | Identifies the vulnerabilities that can be exploited by an external attacker having no access to the subject host. |
| Identifies the vulnerabilities that can be exploited by an external attacker having no access to the subject host. | Identifies the vulnerabilities that can be exploited by an external attacker having no access to the subject host. |
| Identifies the vulnerabilities that can be exploited by an external attacker having no access to the subject host. | Identifies the vulnerabilities that can be exploited by an external attacker having no access to the subject host. |
| ![image](https://github.com/user-attachments/assets/55269c11-f092-48a2-90d7-57021379d1a4) | ![image](https://github.com/user-attachments/assets/c651aadc-64d5-4bf8-abc9-ffb3997a23b0) |

<p><br></p>
<h3><strong>Internal vs. External Scans</strong></h3>

<p>Internal scans are conducted from inside the network, while external scans are conducted from outside the network. Let's see a few of their differences below.<br></p>
<p></p>

| Internal Scans                                 | External Scans                                 |
| :--------------------------------------------: | :--------------------------------------------: | 
| Conducted from inside the network. | Conducted from inside the network. | 
| It focuses on the vulnerabilities that can be exploited inside the network. | It focuses on the vulnerabilities that can be exploited from outside the network. | 
| Identifies vulnerabilities that would be exposed to the attackers once they get inside the network. | Identifies vulnerabilities that would be exposed to the attackers once they get inside the network. |

<p></p>

![image](https://github.com/user-attachments/assets/c00162c9-2714-4b29-9d54-ef6b288aaf79)

<p></p>
<p>The choice between vulnerability scan types depends on several factors. Authenticated scans are often used for internal vulnerability scanning, while unauthenticated scans are mostly used for external vulnerability scanning.<br></p>

> 2.1 - <em>Which type of vulnerability scans require the credentials of the target host?</em><br>
>> <strong>Authenticated</strong><br>
<p><br></p>

> 2.2 - <em>Which type of vulnerability scans require the credentials of the target host?</em><br>
>> <strong>External</strong><br>
<p><br></p>

<h2>Task 3 - Tools for Vulnerability Scanning</h2>

> 3.1 - <em>Is Nessus currently an open-source vulnerability scanner? (Yea/Nay)</em><br>
>> <strong>Nay</strong><br>
<p></p>

> 3.2 - <em>Which company developed the Nexpose vulnerability scanner?</em><br>
>> <strong>Rapid7</strong><br>
<p></p>

> 3.3 - <em>What is the name of the open-source vulnerability scanner developed by Greenbone Security?</em><br>
>> <strong>OpenVAS</strong><br>
<p></p>

<h2>Task 4 - CVE & CVSS</h2>

> 4.1 - <em>CVE stands for?</em><br>
>> <strong>Common Vulnerabilities and Exposures</strong><br>
<p></p>

> 4.2 - <em>Which organization developed CVE?</em><br>
>> <strong>MITRE Corporation</strong><br>
<p></p>

> 4.3 - <em>What would be the severity level of the vulnerability with a score of 5.3?</em><br>
>> <strong>Medium</strong><br>
<p></p>


<h2>Task 5 - OpenVAS</h2>

<p>As discussed in Task #3, OpenVAS is a complete open-source vulnerability scanner. In this task, we will see how to conduct a vulnerability scan using the OpenVAS scanner.</p>

<h3><strong>Installation</strong></h3>
<p>We will be installing OpenVAS on an Ubuntu machine. The installation of OpenVAS can be very hectic as it has many dependencies. We will use docker to install OpenVAS. Docker is a platform that helps you create and distribute packages of different applications. These packages are known as containers. A container of an application has all the dependencies already installed inside it, so we do not need to spend more time installing the application’s dependencies. For your ease, we have already installed the OpenVAS tool on the machine given for the practical exercise in the next task. However, just for your information, the installation steps are mentioned below:<br></p>

<p></p>
<pre><code>sudo apt install docker.io</code></pre>

<p>As the docker is now installed on our machine, we will run the following command to install the OpenVAS container with all the dependencies installed:</p>

<p></p>
<pre><code>sudo docker run -d -p 443:443 –name openvas mikesplain/openvas</code></pre>

<h3><strong>Accessing OpenVAS</strong></h3>

<p>Once you have completed the installation process mentioned above, you can access the OpenVAS web interface by opening any of your browsers and typing the following in the URL:<br></p>
<p></p>
<pre><code>https://127.0.0.1</code></pre>
<p></p>
<p>This will take you to the login page of OpenVAS. Once you enter the correct login credentials, the following dashboard will open. This dashboard provides a comprehensive overview of all your vulnerability scans:</p>

![image](https://github.com/user-attachments/assets/b38a8a80-adf7-44f3-ba36-03e60ce69113)

<h3><strong>Accessing OpenVAS</strong></h3>
<p>Now, we are going to perform a vulnerability scan on a machine. The first step is to create a task inside the OpenVAS dashboard. We will fill out the details for this task and execute it to run the vulnerability scan.<br><br>

Click the “Tasks” option available inside the “Scans” option displayed on the dashboard:<br><br>

You will reach the page where all the running tasks are displayed. We would not see any task on this page because we have not yet performed any scans. To create a task, click the star icon and then the “New Task” option as highlighted in the screenshot:<br></p>

![image](https://github.com/user-attachments/assets/c66ddfc0-67a8-4817-95af-b13f3b340498)

<p>Enter the name of the task, and click the “Scan Targets” option as highlighted in the screenshot:</p>

![image](https://github.com/user-attachments/assets/353a4d31-86cd-4ed5-9f8d-e0aa7b577dd5)

<p>Enter the name of the target machine and its IP address, and click “Create”:</p>

![image](https://github.com/user-attachments/assets/bb6d0bf2-474d-46ba-a010-cbcfee0becb6)

<p>You will have multiple scan options available. Each scan option has its scope of scanning; you can study the details of each scan type and choose accordingly, and then click on the “Create” button:</p>

![image](https://github.com/user-attachments/assets/3c29e31b-e54e-4e7d-9c20-008b5f944767)

<p>The task is created and will be displayed to you on the Tasks dashboard. To initiate the scan, click the play button in the “Actions” option of the task:</p>

![image](https://github.com/user-attachments/assets/f983a164-6de7-4f8e-9bb1-85a7c4c2966a)

<p>It will take a few minutes to complete the scan. After the scan is completed, you will see its status marked as “Done”. The visualizations inside the Tasks dashboard will display some numbers indicating the severity of vulnerabilities found. To check the details of the scan, you have to click on the task name:</p>

![image](https://github.com/user-attachments/assets/aed534a5-5c21-4902-b067-e185a59d559d)

<p>To see the details of all the vulnerabilities discovered during the scan, you can click on the number indicating the count of vulnerabilities found in the subject host:</p>

![image](https://github.com/user-attachments/assets/aef9c473-79ee-4063-8c61-94ca509d445c)

<p>Now, we have a list of all the vulnerabilities found in this machine and their severity. We can also click on any of them to see more details:</p>

![image](https://github.com/user-attachments/assets/f11bad54-cd19-4872-99cc-ab6fd4bbdbe4)

<p>Like other vulnerability scanners, OpenVAS allows us to export these results as reports. You can fetch the reports in any format from the Tasks dashboard.</p>

> 5.1 - <em>What is the IP address of the machine scanned in this task?</em><br>
>> <strong>10.10.154.44</strong><br>
<p></p>

> 5.2 - <em>How many vulnerabilities were discovered on this host?</em><br>
>> <strong>13</strong><br>
<p></p>

![image](https://github.com/user-attachments/assets/defc0189-4a06-453b-aeae-0ef7f9374c6b)

<h2>Task 6 - Practical Exercise</h2>

<p><strong>Scenario</strong>: A reputable firm conducted a vulnerability scan on a server (10.10.26.137) on its network that stores critical information. This activity was intended to enhance the organization’s security posture. The security team conducted the activity using the OpenVAS vulnerability scanner, and the vulnerability scan report was placed on the desktop. You are an information security engineer working for that firm. You are tasked with reviewing this report. You can simply open the report placed on the desktop or perform the vulnerability scan again to answer the questions below. OpenVAS is pre-installed on the host to which you are given access.<br><br>
 
<strong>Note</strong>: Performing the vulnerability scan may take some time. This is why we have already placed the scan report on the desktop so you can analyze and answer the questions.<br><br>

You can start the <strong>Virtual Machine</strong> by pressing the <strong>Start Machine</strong> button below. The machine will start in <strong>Split-Screen</strong> view. In case the VM is not visible, use the blue Show Split View button at the top of the page.</p>

![image](https://github.com/user-attachments/assets/3d2b642a-a6cc-4e00-991d-da8bbbe21ec7)

<p>Once the machine has started, if you prefer to perform the vulnerability scan yourself rather than analyzing the scan report, you must start the docker container of OpenVAS to access it. You can do so by executing the following command with root privileges:</p>

<p>As the docker is started, you can now access OpenVAS by typing the following URL inside the browser:<br>

<code>https://127.0.0.1/login/login.html</code>
<br>
The default login credentials of the tool are mentioned below:<br>

<strong>Username: admin</strong><br>

<srtrong>Password: admin</strong><br>

<strong>Note</strong>: Please be aware that the scanning process can be slow. </p>

> 6.1 - <em>What is the score of the single high-severity vulnerability found in the scan?</em><br>
>> <strong>10.10.154.44</strong><br>
<p></p>

> 6.2 - <em>What is the solution suggested by OpenVAS for this vulnerability?</em><br>
>> <strong>13</strong><br>
<p></p>


<h2>Room Completed</h2>

<p>Keep learning, keep growing!<br>
    
<a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a></p>

![image](https://github.com/user-attachments/assets/fd8e1dcc-2cf5-4754-8c88-2ec3b2244291)
