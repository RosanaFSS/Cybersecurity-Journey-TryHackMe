<p align="center">November 30, 2024</p>
<p align="center">Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m genuinely excited to join you on this adventure.<br>
It´s part of my $$\textcolor{#FF69B4}{\textbf{208}}$$-day-streak in  <a href="https://tryhackme.com/r/hacktivities">TryHackMe</a>.</p>

<h1 align="center">
  $$\textcolor{#3bd62d}{\textnormal{ Spring4Shell: CVE-2022-22965}}$$
</h1>
<p align="center">Interactive lab for exploiting Spring4Shell (CVE-2022-22965) in the Java Spring Framework</p>
<p align="center">Access this TryHackMe FREE Room clicking <a href="https://tryhackme.com/r/room/spring4shell">Spring4Shell: CVE-2022-22965</a>.</p><br>
<p align="center">
  <img height="150px" hspace="20" src="https://github.com/user-attachments/assets/33f21416-dc8a-4e41-869d-cf884ca27481">
  <img height="150px" src="https://github.com/user-attachments/assets/2d60414b-1068-44d4-b21d-a1c99e6db148">
</p>

<h2>Task 1. Info - Introduction and Deploy<a id='1'></a></h2>
<p>In late March 2022, two remote command execution vulnerabilities in the Java Spring framework were made public. The first of these vulnerabilities affects a component of the framework called "Spring Cloud Functions". The second, arguably more serious vulnerability, affects a component in  "Spring Core" —  the heart of the framework — thus significantly increasing the vulnerability's potential impact and earning it the name "Spring4Shell" (a play on Log4Shell, the name of a brutal vulnerability disclosed at the end of 2021).<br>

For various reasons, there has been a lot of confusion surrounding these vulnerabilities in the wider infosec community. As such, this room may be updated as new information comes to light. On a similar note, the impact of Spring4Shell is currently unknown; only time will tell how wide-spread the vulnerability is in the wild.<br>

This room will provide an overview of the Spring4Shell RCE vulnerability in Spring Core, as well as give you an opportunity to exploit it for yourself in the vulnerable machine attached to this task. We will start by taking a look at the vulnerability at a high-level, before exploiting the target machine for ourselves.<br>

Let's begin!</p>


<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 1.1. <em>Deploy the target machine by clicking the green button at the top of this task!</em><br>
> <strong>Note:</strong> <em>This machine will take 2-3 minutes to start up completely</em>.<a id='1.1'></a>
>> <code><strong>No answer needed</strong></code><br><br>

<br>
<h2>Task 2 - Tutorial - Vulnerability Background<a id='2'></a></h2>

<h3>Overview</h3>
<p>Spring4Shell was originally released as an 0-day in a now-deleted thread of Tweets. It was quickly identified as a bypass of the patch for <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1622">CVE-2010-1622</a> — a vulnerability in earlier versions of the Spring Framework which allowed attackers to obtain remote command execution by abusing the way in which Spring handles data sent in HTTP requests. In short, the vulnerability allows attackers to upload a "webshell" (a piece of code which accepts commands from the attacker that the webserver is then tricked into executing) to the vulnerable server, achieving remote command execution.</p>

<h3>How Does it Work?</h3>
<p>To understand Spring4Shell, it is important that we understand CVE-2010-1622. Spring MVC (Model-View-Controller) is part of the Spring Framework which makes it easy to develop web applications following the MVC design pattern. One of the features of Spring MVC is that it automatically instantiates and populates an object of a specified class when a request is made based on the parameters sent to the endpoint. In simple terms, this could be abused to overwrite important attributes of the parent class, resulting in remote code execution.<br>

Spring4Shell works along similar lines, bypassing the mitigations that were added to patch CVE-2010-1622. The majority of the exploits for the Spring4Shell vulnerability operate by forcing the application to write a malicious <code>.jsp</code> file (effectively plaintext Java which Tomcat can execute — much like a PHP webserver would execute files with a <code>.php</code> extension) to the webserver. This webshell can then be executed to gain remote command execution over the target.</p>

<h3>Limitations</h3>
<p>Fortunately, despite how commonly used the Spring Framework is, the conditions in which the vulnerability can be exploited are actually fairly limited.<br>

The Spring4Shell vulnerability affects Spring Core before version 5.2, as well as in versions 5.3.0-17 and 5.2.0-19, running on a version of the Java Development Kit (JDK) greater than or equal to 9. The publicly available exploits currently available only work on applications deployed to Apache Tomcat as WARs; however, the Spring Framework maintainers have stated that they believe there may be other ways to exploit the vulnerability.<br>

Current conditions for vulnerability (as stated in <a href="https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement">Spring's announcement of the vulnerability</a>) can be summarised as follows:</p>

<ul style="list-style-type:square">
    <li>JDK 9+</li>
    <li>A vulnerable version of the Spring Framework (<5.2 | 5.2.0-19 | 5.3.0-17)</li>
    <li>Apache Tomcat as a server for the Spring application, packaged as a WAR</li>
    <li>A dependency on the <code>spring-webmvc</code> and/or <code>spring-webflux</code>code> components of the Spring Framework</li>
</ul></p>

<p>It is worth noting, however, that these may change over time as other ways to exploit the vulnerability are discovered.</p>

<h3>Remediations</h3>
<p>Fortunately, patched versions of the Spring Framework have been released. To remediate Spring4Shell, ensure that you are using a version of Spring released after patch 18 of minor release 5.3 (i.e. after 5.3.18), or after patch 20 if using minor release 5.2 (i.e. after 5.2.20). Upgrading the version of the framework is enough to remove the vulnerability from your applications.<br>

If upgrading is not possible, it is possible to somewhat mitigate this vulnerability by setting a blocklist of vulnerable field patterns. More advice on this can be found <a href="https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement">here</a>.</p>


<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 2.1. <em>Read the task information and understand how Spring4Shell works at a high level.</em><br><a id='1.1'></a>
>> <code><strong>No answer needed</strong></code><br><br>

<br>
<h2>Task 3 - Practical - Exploitation<a id='3'></a></h2>

<br>
<h2>Task 4 - Info - Conclusion<a id='4'></a></h2>

<br>
<h2>Room Complete<a id='5
                   
<br>
<h2>My Journey<a id='6'></a></h2>'></a></h2>
