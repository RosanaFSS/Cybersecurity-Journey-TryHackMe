<p align="center">May 7, 2025<br>
Hey there, fellow lifelong learner! I¬¥m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I‚Äôm genuinely excited to join you on this adventure.<br>
It¬¥s part of my $$\textcolor{#FF69B4}{\textbf{366}}$$-day-streak in  <a href="https://tryhackme.com">TryHackMe</a>.<br><br>
<img width="300px" src="https://github.com/user-attachments/assets/c1a1f7f1-15b0-4746-8d9c-8e2ebd056f86" alt="Your Image Badge"><br></p>
<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{Atlassian CVE-2022-26134}}$$</h1>
<p align="center"><em>An interactive lab showcasing the Confluence Server and Data Center un-authenticated RCE vulnerability.</em>.<br>
It is classified as an easy-level walkthrough.<br>
You can join it for üÜì using your own virtual machine with openVPN or TryHackMe¬¥s AttackBox if you are subscribed.<br>
Can be accessed clicking  <a href="https://tryhackme.com/room/cve202226134">here</a>.</p>

<p align="center"> <img width="1000px" src="https://github.com/user-attachments/assets/fb02db7b-d472-4cf1-8528-5b85d2e2716d"> </p>

<br>
<br>

<h2>Task 1 . Introduction</h2>

<p>On May the 30th, 2022, an organisation named Volexity identified an un-authenticated RCE vulnerability (scoring 9.8 on NIST) within Atlassian's Confluence Server and Data Center editions.<br><br>

Confluence is a collaborative documentation and project management framework for teams. Confluence helps track project status by offering a centralised workspace for members.</p>

<p>The following versions of Confluence are vulnerable to this CVE:<br>

1.3.0 -> 7.4.17<br>
7.13.0 -> 7.13.7<br>
7.14.0 -> 7.14.3 <br>
7.15.0 -> 7.15.2 <br>
7.16.0 -> 7.16.4<br>
7.17.0 -> 7.17.4<br>
7.18.0 -> 7.18.1 <br><br>

You can view the NIST entry for CVE-2022-26134 here.</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 1.1. <em>What is the full CVE entry for this exploit?</em>.<a id='1.1'></a>
>> <code><strong>CVE-2022-26134</strong></code><br>

<br>

> 1.2. <em>You discover a server running Confluence with the version of 7.16.2, is this vulnerable? Answer format: yay/nay</em>.<a id='1.2'></a>
>> <code><strongyay</strong></code><br>

<br>
<br>

<h2>Task 2 . Deploy the vulnerable machine</h2>

<p>Now it is time to practice this vulnerability! Deploy the machine attached to this task, and craft different payloads to answer the questions below.<br><br>

Note: Please wait for a minimum of seven minutes for this machine to start up before attacking. You can verify the machine is ready for attack once the login page on the following URL loads: HTTP://MACHINE_IP:8090. In the meanwhile, proceed with the rest of the tasks.</p>

<p><em>The Confluence login panel on HTTP://MACHINE_IP:8090.</em></p>

![image](https://github.com/user-attachments/assets/49188e8b-b678-45a7-a8c7-6a1706fab88d)

<br>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 2.1. <em>Deploy the machine attached to this task by pressing the green button labelled "Start Machine" and proceed with the tasks.</em>.<a id='2.1'></a>
>> <code><strong>No answer needed</strong></code><br>

<br>


<p>Navigated to <code>http://TargetIP:8090</code></p>

<br>


![image](https://github.com/user-attachments/assets/d3553c15-fc00-4823-bb86-7bd26fc38537)


<br>
<br>

<h2>Task 3 . Explaining the Vulnerability</h2>
<p>This CVE uses a vulnerability within the OGNL (Object-Graph Navigation Language) expression language for Java (surprise, surprise ... it's Java). OGNL is used for getting and setting properties of Java objects, amongst many other things.<br><br>

For example, OGNL is used to bind front-end elements such as text boxes to back-end objects and can be used in Java-based web applications such as Confluence. We can see how OGNL is used in the screenshot below. Values are input to a web form, where these values will be stored into objects within the application:</p>

<p><em>Thanks to Journaldev.com for this example of OGNL in use.</em></p>

![image](https://github.com/user-attachments/assets/d8802c5c-5272-41f9-9b36-f6673175e77f)

<br>

<p>We can abuse the fact that OGNL can be modified; we can create a payload to test and check for exploits.</p>

<br>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 3.1. <em>What does the acronym OGNL stand for?</em>.<a id='3.1'></a>
>> <code><strong>Object-Graph Navigation Language</strong></code><br>

<br>
<br>

<h2>Task 4 . Exploit Detection and Patching</h2>
<h3>Patching</h3>h3>

<p>Atlassian has released an advisory for their products affected by this CVE, which you can read here. To resolve the issue, you need to upgrade your Confluence version. The suggested list at the time of publication is:<br><br>

-7.4.17<br>
- 7.13.7<br>
- 7.14.3<br>
- 7.15.2<br>
- 7.16.4<br>
- 7.17.4<br>
- 7.18.1</p>

<h3>Detection - Log Files</h3>

<p>Confluence is an Apache Tomcat server which has logging located in <code>/opt/atlassian/confluence/logs</code>. You can use commands like grep to search for HTTP GET requests of payloads that are using Java runtime to execute commands. For example:<br><br>

- <code>grep -R "/%24%7B%40java.lang.Runtime%40getRuntime%28%29.exec%28%22"</code> in catalina.out</p>

<h3>Detection - YARA</h3>

<p>If you have Yara installed on the server running Confluence, Volexity (the finders of the vulnerability) has created the following Yara rule for you to use, located here.<br><br>

Unfamiliar with Yara? Check out our Yara room here.<br>

Atlassian Documentation: https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html<br>
Yara link: https://github.com/volexity/threat-intel/blob/main/2022/2022-06-02%20Active%20Exploitation%20Of%20Confluence%200-day/indicators/yara.yar<br>
Yara room: https://tryhackme.com/room/yara</p>

<br>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 4.1. <em>I've updated my vulnerable install!</em>.<a id='4.1'></a>
>> <code><strong>No answer needed</strong></code><br>

<br>
<br>

<h2>Task 5 . Exploitation</h2>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 5.1. <em>Download the proof of concept for this task! If you are using the AttackBox, this is already done for you, where it can be found in /root/Rooms/CVE2022-26134.</em>.<a id='5.1'></a>
>> <code><strong>No answer needed</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/2d7a61be-7d52-46f9-b098-d1d7a8e9343e)

<br>

> 5.2. <em>Ensure the login panel on HTTP://10.10.9.129:8090 loads before proceeding.</em>.<a id='5.2'></a>
>> <code><strong>No answer needed</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/5ba6c8cd-e4b0-417f-8da8-0366d2dd89a4)

<br>

> 5.3. <em>Craft a payload to identify what user the application is running as. What is the user?</em>.<a id='5.3'></a>
>> <code><strong>confluence</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/392bd476-06de-4509-8bd6-0dd90c4b097e)

<br>


> 5.4. <em>Finally, craft a payload to retrieve the flag stored at  /flag.txt on 10.10.9.129. What is the flag?</em>.<a id='5.4'></a>
>> <code><strong>THM{OGNL_VULN}</strong></code><br>

<br>

![image](https://github.com/user-attachments/assets/0fd95f82-c292-421f-9347-a71cac74e5cd)

<br>
<br>

<h2>Task 6 . Conclusion</h2>
<p>Nice work!<br><br>

Hope you enjoyed this brief showcase of the CVE-2022-26134 OGNL Injection vulnerability. Remember, OGNL is an expression language for Java-based web applications, so this vulnerability will also apply to other web apps running the same classes that Confluence uses!</p>

<p>[ ... ]</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 6.1. <em>Terminate the VM attached to this room to conclude the room.</em>.<a id='6.1'></a>
>> <code><strong>No answer needed</strong></code><br>


<br>
<br>

<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{Room Completed}}$$</h1>
<br>

<p align="center">
<img width="1000px" src="https://github.com/user-attachments/assets/7c9aab60-e7c2-48ba-9715-c64a66d29ab9"><br>
<img width="1000px" src="https://github.com/user-attachments/assets/dfe452f9-dcbb-4afc-8505-758976d34f0f"></p>


<br>

<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{My TryHackMe Journey}}$$ </h1>
<br>

<div align="center">

|       Date        |   Streak |   All Time   |   All Time   |   Monthly   |   Monthly  |  Points  |   Rooms   |   Badges  |
| :---------------: | :------: | :----------: | :----------: | :---------: | :--------: | :------  | :-------: | :-------: |
|                   |          |    Global    |    Brazil    |    Global   |   Brazil   |          | Completed |           |
|    May 7, 2025    |    366   |     237·µó ∞    |      5·µó ∞     |     685·µó ∞   |     12‚Åø·µà   | 100,129  |    714   |     602    |

</div>

<br>

![image](https://github.com/user-attachments/assets/8d53fb2c-7fe1-4fda-a0bc-3c89d4e98b31)


<p align="center"> Global All Time: 237·µó ∞<br><br><img width="1000px" src="https://github.com/user-attachments/assets/354cb72b-d8e8-4f34-bdf9-41b089256e09"> </p>

<p align="center"> Brazil All Time:   5·µó ∞<br><br><img width="1000px" src="https://github.com/user-attachments/assets/35965b2b-f1e3-4c78-9070-337dd678bd67"> </p>

<p align="center"> Global monthly:  685·µó ∞<br><br><img width="1000px" src="https://github.com/user-attachments/assets/c898593b-3327-4a91-9992-73cea6663b00"> </p>

<p align="center"> Brazil monthly:   12‚Åø·µà<br><br><img width="1000px" src="https://github.com/user-attachments/assets/8d53fb2c-7fe1-4fda-a0bc-3c89d4e98b31"> </p>


<br>
<br>

<h1 align="center">$$\textcolor{#3bd62d}{\textnormal{Thanks for coming!!!}}$$</h1>

<p align="center">Follow me on <a href="https://medium.com/@RosanaFS">Medium</a>, here on <a href="https://github.com/RosanaFSS/TryHackMe">GitHub</a>, and on <a href="https://www.linkedin.com/in/rosanafssantos/">LinkedIN</a>.</p> 

<br>

<h1 align="center">$$\textcolor{#3bd62d}{\textnormal{Thank you}}$$</h1>
<p align="center"><a href="https://tryhackme.com/p/tryhackme">tryhackme</a>  and <a href="https://tryhackme.com/p/cmnatic">cmnatic</a> for investing your time and effort to develop this walkthrough so that I could sharpen my skills!</p>
