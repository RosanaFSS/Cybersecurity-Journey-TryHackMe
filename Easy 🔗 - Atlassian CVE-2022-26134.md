May 7, 2025<br>
Day 366<br>

<h1>Atlassian CVE-2022-26134</h1>

<br>
<br>

<h2>Task 1 . Introduction</h2>

<p>On May the 30th, 2022, an organisation named Volexity identified an un-authenticated RCE vulnerability (scoring 9.8 on NIST) within Atlassian's Confluence Server and Data Center editions.<br><br>

Confluence is a collaborative documentation and project management framework for teams. Confluence helps track project status by offering a centralised workspace for members.</p>

<p>The following versions of Confluence are vulnerable to this CVE:<br>

1.3.0 -> 7.4.17<br>
7.13.0 -> 7.13.7<br>
7.14.0 -> 7.14.3 <br>
7.15.0 -> 7.15.2 <br>
7.16.0 -> 7.16.4<br>
7.17.0 -> 7.17.4<br>
7.18.0 -> 7.18.1 <br><br>

You can view the NIST entry for CVE-2022-26134 here.</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 1.1. <em>What is the full CVE entry for this exploit?</em>.<a id='1.1'></a>
>> <code><strong>CVE-2022-26134</strong></code><br>

<br>

> 1.2. <em>You discover a server running Confluence with the version of 7.16.2, is this vulnerable? Answer format: yay/nay</em>.<a id='1.2'></a>
>> <code><strongyay</strong></code><br>

<br>
<br>

<h2>Task 2 . Deploy the vulnerable machine</h2>

<p>Now it is time to practice this vulnerability! Deploy the machine attached to this task, and craft different payloads to answer the questions below.<br><br>

Note: Please wait for a minimum of seven minutes for this machine to start up before attacking. You can verify the machine is ready for attack once the login page on the following URL loads: HTTP://MACHINE_IP:8090. In the meanwhile, proceed with the rest of the tasks.</p>

<p><em>The Confluence login panel on HTTP://MACHINE_IP:8090.</em></p>

![image](https://github.com/user-attachments/assets/49188e8b-b678-45a7-a8c7-6a1706fab88d)

<br>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 2.1. <em>Deploy the machine attached to this task by pressing the green button labelled "Start Machine" and proceed with the tasks.</em>.<a id='2.1'></a>
>> <code><strong>No answer needed</strong></code><br>

<br>


<p>Navigated to <code>http://TargetIP:8090</code></p>

<br>






<br>

<h2>Task 3 . Explaining the Vulnerability</h2>
<p>This CVE uses a vulnerability within the OGNL (Object-Graph Navigation Language) expression language for Java (surprise, surprise ... it's Java). OGNL is used for getting and setting properties of Java objects, amongst many other things.<br><br>

For example, OGNL is used to bind front-end elements such as text boxes to back-end objects and can be used in Java-based web applications such as Confluence. We can see how OGNL is used in the screenshot below. Values are input to a web form, where these values will be stored into objects within the application:</p>

<p><em>Thanks to Journaldev.com for this example of OGNL in use.</em></p>

![image](https://github.com/user-attachments/assets/d8802c5c-5272-41f9-9b36-f6673175e77f)

<br>

<p>We can abuse the fact that OGNL can be modified; we can create a payload to test and check for exploits.</p>

<br>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 3.1. <em>What does the acronym OGNL stand for?</em>.<a id='3.1'></a>
>> <code><strong>Object-Graph Navigation Language</strong></code><br>

<br>
<br>

<h2>Task 4 . Exploit Detection and Patching</h2>
<h3>Patching</h3>h3>

<p>Atlassian has released an advisory for their products affected by this CVE, which you can read here. To resolve the issue, you need to upgrade your Confluence version. The suggested list at the time of publication is:<br><br>

-7.4.17<br>
- 7.13.7<br>
- 7.14.3<br>
- 7.15.2<br>
- 7.16.4<br>
- 7.17.4<br>
- 7.18.1</p>

<h3>Detection - Log Files</h3>

<p>Confluence is an Apache Tomcat server which has logging located in <code>/opt/atlassian/confluence/logs</code>. You can use commands like grep to search for HTTP GET requests of payloads that are using Java runtime to execute commands. For example:<br><br>

- <code>grep -R "/%24%7B%40java.lang.Runtime%40getRuntime%28%29.exec%28%22"</code> in catalina.out</p>

<h3>Detection - YARA</h3>

<p>If you have Yara installed on the server running Confluence, Volexity (the finders of the vulnerability) has created the following Yara rule for you to use, located here.<br><br>

Unfamiliar with Yara? Check out our Yara room here.</p>





