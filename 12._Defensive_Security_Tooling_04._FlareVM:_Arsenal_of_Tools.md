<h3> Welcome to the <em>TryHackMe ...</em></h3>
<h1>Cyber Security 101 learning path > Defensive Security Tooling ></h1 >
<h2>FlareVM: Arsenal of Tools</h2>
<p>Learn the arsenal of investigative tools in FlareVM.</p><br>
<p>October 28, 2024<br></p>

<div style="display: flex; justify-content: center; align-items: center;">
    <img src="https://github.com/user-attachments/assets/2bf88a8e-4032-4f13-8eef-d5e3c7448fbd" width="150px" height="150px"/>
</div>
<br>

![image](https://github.com/user-attachments/assets/10528fb1-8025-41a2-9b97-5f9d69454d97)


<p>Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m genuinely excited to join you on this adventure.<br>
It´s key part of my 175-day-streak.<br>Let´s get started!!<br><br>
Access this TryHackMe Room clicking <a href="https://tryhackme.com/r/room/flarevmarsenaloftools">FlareVM: Arsenal of Tools</a>.<br>
<code>Note</code>: only subscribers can deploy Virtual Machines in this room.</p>

<h2>Task 1 - Introduction</h2>
<p><strong>FlareVM</strong>, or "<strong>Forensics, Logic Analysis, and Reverse Engineering,</strong>strong>" stands out as a comprehensive and carefully curated collection of specialized tools uniquely designed to meet the specific needs of reverse engineers, malware analysts, incident responders, forensic investigators, and penetration testers. This toolkit, expertly crafted by the FLARE Team at FireEye, is a powerful aid in unravelling digital mysteries, gaining insight into malware behaviour, and delving into the complex details within executables. </p>

![image](https://github.com/user-attachments/assets/a65b2343-ef09-4d81-a3d5-3ce20fd54197)

<h3>Learning Objectives</h3>
<ul style="list-style-type:square">
    <li>Explore tools inside the FlareVM.</li>
    <li>Learn how to use tools to analyze potentially malicious processes effectively.</li>
    <li>Be familiar with the tools used for static analysis of malicious documents and binaries.</li>
</ul>

<h3>Room Prerequisites</h3>
<p>This room expects that you are familiar with various technical terms related to Windows and processes. If you are unfamiliar with these terms, please consider joining the <a href="https://tryhackme.com/r/path/outline/presecurity">Pre Security</a> path.</p>

<h3>RVM Access</h3>
<p>Getting your hands on this tool can be pretty daunting at first, as building it starting from scratch takes a lot of time, and the installation will take several hours! Thankfully, we have already included this machine in this room.<br>

Click on the <strong>Start Machine</strong> button below. This should initialize an instance on FlareVM.</p>

![image](https://github.com/user-attachments/assets/217e0ca4-8b5e-4ccb-99b2-745fc7cb2dc3)

<br>
<p>We will use the tool inside the machine attached to this task. The machine will start in a split-screen view. If you opt to access the machine via Remote Desktop (RDP), you may also use the following credentials below.</p>
<br>

![image](https://github.com/user-attachments/assets/2f885b69-181e-43f2-9fa9-1ef690b1c82b)

<p>Almost all the files we will use in this room are located in the <code>C:\Users\Administrator\Desktop\Sample</code> folder.<br>

<strong>Disclaimer</strong>: The FlareVM machine attached to this room contains malicious sample files as part of the practical exercises and has no internet access. These files should not be downloaded, executed (outside the FlareVM machine), or distributed under any circumstances. Doing so could potentially harm your system or network. Always handle such files only in isolated, controlled, and secure environments.</p>

> 1.1 - <em>I'm ready to learn more about FlareVM!</em><br>
>> <code>No answer needed</code><br>
<p><br></p>


<h2>Task 2 - Arsenal of Tools</h2>
<br>

![image](https://github.com/user-attachments/assets/49c47d88-49cf-4e35-9989-bd0c33e0c5f6)
![image](https://github.com/user-attachments/assets/eb11b280-d852-4c81-8631-e480f2ea844d)

<br>

> 2.1 - <em>Which tool is an Open-source debugger for binaries in x64 and x32 formats?</em><br>
>> <code>x64dbg</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/ae768396-c1b1-451d-9f85-e68effd1f44d)

<br>

> 2.2 - <em>What tool is designed to analyze and edit Portable Executable (PE) files?</em><br>
>> <code>CFF Explorer</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/79faa598-3546-435a-aad6-cf7516b1811e)

<br>

> 2.3 - <em>Which tool is considered a sophisticated memory editor and process watcher?</em><br>
>> <code>Process Hacker</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/d85931c4-4e11-44ae-877f-6d47fbd11bc6)

<br>

> 2.4 - <em>Which tool is used for Disc image acquisition and analysis for forensic use?</em><br>
>> <code>FTK Imager</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/d2b72de4-f169-45d8-986f-de30a53ef35c)

<br>

> 2.5 - <em>What tool can be used to view and edit a binary file?</em><br>
>> <code>HxD</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/64cf8d13-cfbd-4867-be4d-bb5dbdad2572)

<br>

<h2>Task 3 - Commonly Used Tools for Investigation: Overview</h2>
<br>

![image](https://github.com/user-attachments/assets/e4cbeb53-16fb-4d03-a2d3-d5f4fc1c033c)

![image](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e6bbe59a46ee9407fd65bbe/room-content/5e6bbe59a46ee9407fd65bbe-1727302306550.png)

![image](https://github.com/user-attachments/assets/54b4246d-da79-4d0b-8417-7a94f13aebcd)

![image](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e6bbe59a46ee9407fd65bbe/room-content/5e6bbe59a46ee9407fd65bbe-1727171765939.png)

![image](https://github.com/user-attachments/assets/3e3c77e6-a6ff-49a1-9077-37a646f49135)

![image](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e6bbe59a46ee9407fd65bbe/room-content/5e6bbe59a46ee9407fd65bbe-1727170785692.png)

![image](https://github.com/user-attachments/assets/dd6803da-3848-40d1-aea3-208c12c9a375)

![image](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e6bbe59a46ee9407fd65bbe/room-content/5e6bbe59a46ee9407fd65bbe-1727170785706.png)

![image](https://github.com/user-attachments/assets/9e838f65-a041-4425-bd60-fab56ef73283)

![image](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e6bbe59a46ee9407fd65bbe/room-content/5e6bbe59a46ee9407fd65bbe-1727170785704.png)

![image](https://github.com/user-attachments/assets/8fb69b39-2e32-4cfc-a98c-03e6b7fece4f)

![image](https://tryhackme-images.s3.amazonaws.com/user-uploads/5e6bbe59a46ee9407fd65bbe/room-content/5e6bbe59a46ee9407fd65bbe-1727170785666.png)

![image](https://github.com/user-attachments/assets/e1dc1d8c-38d5-45ed-8d6d-d5e2cd8a63f2)

![image](https://github.com/user-attachments/assets/ef3400e1-7de5-427e-8bbb-3db00101894f)

<p>View Results</p>

<pre><code>
FLARE FLOSS RESULTS (version v3.1.0-0-gdb9af41)

+------------------------+------------------------------------------------------------------------------------+
| file path              | cobaltstrike.exe                                                                   |
| identified language    | unknown                                                                            |
| extracted strings      |                                                                                    |
|  static strings        | 189 (2050 characters)                                                              |
|   language strings     |   0 (   0 characters)                                                              |
|  stack strings         | 0                                                                                  |
|  tight strings         | 0                                                                                  |
|  decoded strings       | 0                                                                                  |
+------------------------+------------------------------------------------------------------------------------+


 ────────────────────────────
  FLOSS STATIC STRINGS (189)
 ────────────────────────────

+-----------------------------------+
| FLOSS STATIC STRINGS: ASCII (188) |
+-----------------------------------+

!This program cannot be run in DOS mode.
.text
P`.data
.rdata
P@.pdata
0@.xdata
0@.bss
.idata
.CRT
.tls
ffffff.
ATUWVSH
T$ E
t6H9
[^_]A\
ATUWVSH
L$ < H
@[^_]A\
UWVSH
L$LA
X[^_]
UWVSH
L$LA
X[^_]
D$P\
D$He
D$@p
D$8i
D$0p
D$(\
D$ .
T$XH
fff.
D$ tv
D$(H
T$ H
L$ H
L$(H
ATUWVSH
 [^_]A\
ffff.
CCG
8[^H
T$(H
\$8H
L$ H
ATUWVSH
d$0H
l$(H
@[^_]A\
D$XH
T$XL
D$`L
L$hH
ffffff.
AUATUWVSH
[^_]A\A]
T$PH
T$ H
[^_]A\A]
T$hH
L$PM
T$8H
L$ H
T$8L
[^_]A\A]
ATWVSH
[^_A\]
D$ H
tXw!
9MZt
HcQ<H
HcA<H
WVSH
tWHc
 [^_
 [^_
tPHc
B' t\tH
ffff.
UWVSH
tSHc
([^_]
([^_]
ATUWVSH
@[^_]A\
L3d$0H
@[^_]A\
D$0H
D$(H
UWVSH
([^_]H
UWVSH
([^_]
([^_]
QPH=
mNAj
+5:
mNAj
=E,z
mUDj
mN[3\
z(8(
R^~4
?\t{\
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAp
_set_invalid_parameter_handler
%c%c%c%c%c%c%c%c%cMSSE-%d-server
.pdata
Argument domain error (DOMAIN)
Argument singularity (SIGN)
Overflow range error (OVERFLOW)
Partial loss of significance (PLOSS)
Total loss of significance (TLOSS)
The result is too small to be represented (UNDERFLOW)
Unknown error
_matherr(): %s in %s(%g, %g)  (retval=%g)
Mingw-w64 runtime failure:
Address %p has no image-section
  VirtualQuery failed for %d bytes at address %p
  VirtualProtect failed with code 0x%x
  Unknown pseudo relocation protocol version %d.
  Unknown pseudo relocation bit size %d.
CloseHandle
ConnectNamedPipe
CreateFileA
CreateNamedPipeA
CreateThread
DeleteCriticalSection
EnterCriticalSection
GetCurrentProcess
GetCurrentProcessId
GetCurrentThreadId
GetLastError
GetModuleHandleA
GetProcAddress
GetStartupInfoA
GetSystemTimeAsFileTime
GetTickCount
InitializeCriticalSection
LeaveCriticalSection
LoadLibraryW
QueryPerformanceCounter
ReadFile
RtlAddFunctionTable
RtlCaptureContext
RtlLookupFunctionEntry
RtlVirtualUnwind
SetUnhandledExceptionFilter
Sleep
TerminateProcess
TlsGetValue
UnhandledExceptionFilter
VirtualAlloc
VirtualProtect
VirtualQuery
WriteFile
__C_specific_handler
__dllonexit
__getmainargs
__initenv
__iob_func
__lconv_init
__set_app_type
__setusermatherr
_acmdln
_cexit
_initterm
_onexit
abort
exit
fprintf
free
fwrite
malloc
memcpy
signal
sprintf
strlen
strncmp
vfprintf
KERNEL32.dll
msvcrt.dll


+------------------------------------+
| FLOSS STATIC STRINGS: UTF-16LE (1) |
+------------------------------------+

msvcrt.dll


 ─────────────────────────
  FLOSS STACK STRINGS (0)
 ─────────────────────────



 ─────────────────────────
  FLOSS TIGHT STRINGS (0)
 ─────────────────────────



 ───────────────────────────
  FLOSS DECODED STRINGS (0)
 ───────────────────────────
</code></pre><br>

![image](https://github.com/user-attachments/assets/97d51556-b3b2-45bf-8381-05ec60a62adf)

<p><br></p>

> 3.1 - <em>Which tool was formerly known as FLARE Obfuscated String Solver?</em>
>> <code>FLOSS</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/89cf6977-7a1b-45d6-ab53-a1d8c739f8c2)

> 3.2 - <em>Which tool offers in-depth insights into the active processes running on your computer?</em><br>
>> <code>Process Explorer</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/e627ccbe-a1b9-42f9-bd92-995175a33a05)

> 3.3 - <em>By using the Process Explorer (procexp) tool, under what process can we find smss.exe?</em><br>
>> <code>System</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/ddfa086b-e4d3-4aa5-b8b9-cc3de138debb)

> 3.4 - <em>Which powerful Windows tool is designed to help you record issues with your system's apps?</em><br>
>> <code>Procmon</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/1fad1ac1-73a1-483b-880c-5d2b2c467798)

> 3.5 - <em>Which tool can be used for Static analysis or studying executable file properties without running the files?</em><br>
>> <code>PEStudio</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/99d5ea9c-7b80-4419-a7de-f94f69e952ac)

> 3.6 - <em>Using the tool <code>PEStudio</code> to open the file <code>cryptominer.bin</code> in the <code>Desktop\Sample</code> folder, what is the sha256 value of the file??</em><br>
>> <code>E9627EBAAC562067759681DCEBA8DDE8D83B1D813AF8181948C549E342F67C0E</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/cdd49aa3-53f3-4184-96e0-5b0ac1f32ba7)

> 3.7 - <em>Using the tool <code>PEStudio</code> to open the file <code>cryptominer.bin</code> in the <code>Desktop\Sample</code> folder, how many functions does it have?</em><br>
>> <code>102</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/547a1d6e-1db8-496b-8758-ed30b44e83b0)

> 3.8 - <em>What tool can generate file hashes for integrity verification, authenticate the source of system files, and validate their validity?</em><br>
>> <code>CFF Explorer</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/beef4115-976e-41b0-a050-0fb8d42f886c)

> 3.9 - <em>Using the tool CFF Explorer to open the file <code>possible_medusa.txt</code> in the <code>Desktop\Sample</code> folder, what is the MD5 of the file?</em><br>
>> <code>646698572AFBBF24F50EC5681FEB2DB7</code><br>
<p></p>

![image](https://github.com/user-attachments/assets/eb28ecf5-2591-4ec0-983c-02cdbb8f4b4c)

> 3.10 - <em>Use the CFF Explorer tool to open the file <code>possible_medusa.txt</code> in the <code>Desktop\Sample</code> folder. Then, go to the <code>DOS Header Section</code>. What is the e_magic value of the file?</em>
>> <code>5A4D</code>

![image](https://github.com/user-attachments/assets/80da92f4-18e2-48eb-a4e0-db9fdf8ef562)


<h2>Task 4 - Analyzing Malicious Files!</h2>
<br>

> 4.1 - <em>Using <code>PEStudio</code>, open the file <code>windows.exe</code>. What is the entropy value of the file <code>windows.exe</code>?</em><br>
>> <code>___________</code><br>
<p><br></p>

> 4.2 - <em>Using <code>PEStudio</code>, open the file <code>windows.exe</code>, then go to manifest (administrator section). What is the value under <coded>requestedExecutionLevel</code>?</em><br>
>> <code>___________</code><br>
<p><br></p>

> 4.3 - <em>Which function allows the process to use the operating system's shell to execute other processes?</em><br>
>> <code>___________</code><br>
<p><br></p>

> 4.4 - <em>Which API starts with R and indicates that the executable uses cryptographic functions?</em><br>
>> <code>___________</code><br>
<p><br></p>

> 4.5 - <em>What is the <code>Imphash</code> of <code>cobaltstrike.exe</code>?</em><br>
>> <code>___________</code><br>
<p><br></p>

> 4.6 - <em>What is the defanged IP address to which the process <code>cobaltstrike.exe</code> is connecting?</em><br>
>> <code>___________</code><br>
<p><br></p>

> 4.7 - <em>What is the destination port number used by <code>cobaltstrike.exe</code> when connecting to its C2 IP Address?</em><br>
>> <code>___________</code><br>
<p><br></p>

> 4.8 - <em>During our analysis, we found a process called <code>cobaltstrike.exe</code>. What is the parent process of <code>cobaltstrike.exe</code>? </em><br>
>> <code>___________</code><br>
<p><br></p>

<h2>Task 5 - Conclusion</h2>
<br>

> 5.1 - <em>Fantastic Room!</em><br>
>> <code>No answer needed</code><br>
<p><br></p>

<h2>Room Complete</h2>
<br>
<p>Keep learning, keep growing!<br>

<p>.....................................................................</p>

<h2>My journey</h2>
<br>
<p></p>Following I share the status of my journey in TryHackMe.</p>

<p>.....................................................................</p>

<p></p>

<p style="text-align: center;">Thank you for coming. Hope to learn together again!!</p>


