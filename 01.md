<h1 align="center">Soupedecode 01</h1>
<h3 align="center">Practice $$\textcolor{#3bd62d}{\textnormal{......}}$$.</h3>
<p align="center">August 1, 2025<br>
Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m excited to join you on this adventure, part of my <code>452</code>-day-streak in <a href="https://tryhackme.com">TryHackMe</a>.<br>
Test your enumeration skills on this boot-to-root machine.<br>
Click <a href="https://tryhackme.com/room/soupedecode01">here </a>to access this TryHackMe walkthrough.<br>
<img width="160px" src="https://github.com/user-attachments/assets/8a5ee8d9-c2f2-46b0-9a44-f1010abe2018"><br>
<img width="1200px" src=""></p>


<br>

<h2>Task 1 . Soupedecode 01</h2>
<p>Soupedecode is an intense and engaging challenge in which players must compromise a domain controller by exploiting Kerberos authentication, navigating through SMB shares, performing password spraying, and utilizing Pass-the-Hash techniques. Prepare to test your skills and strategies in this multifaceted cyber security adventure.<br>

Note: Please allow 4 minutes for the VM to properly boot up.</p>

<p><em>Answer the questions below</em></p>

<p>1.1. What is the user flag?<br>
<code>____</code></p>

<br>

<p>1.2. What is the root flag?<br>
<code>____</code></p>


<h3>Nmap</h3>

```bash
:~/Soupedecode01# nmap -sC -sV -Pn -p- -T4 TargetIP
...
PORT      STATE SERVICE       VERSION
53/tcp    open  domain?
| fingerprint-strings: 
|   DNSVersionBindReqTCP: 
|     version
|_    bind
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-08-01 xx:xx:xx)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: SOUPEDECODE
|   NetBIOS_Domain_Name: SOUPEDECODE
|   NetBIOS_Computer_Name: DC01
|   DNS_Domain_Name: SOUPEDECODE.LOCAL
|   DNS_Computer_Name: DC01.SOUPEDECODE.LOCAL
|   Product_Version: 10.0.20348
|_  System_Time: 2025-08-01Txx:xx:xx+00:00
| ssl-cert: Subject: commonName=DC01.SOUPEDECODE.LOCAL
| Not valid before: 2025-06-17Txx:xx:xx
|_Not valid after:  2025-12-17Txx:xx:xx
|_ssl-date: 2025-08-01T21:25:48+00:00; -1s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49664/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49676/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49714/tcp open  msrpc         Microsoft Windows RPC
...
Host script results:
|_clock-skew: mean: -1s, deviation: 0s, median: -1s
|_nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 16:ff:f9:08:26:3f (unknown)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2025-08-01Txx:xx:xx
|_  start_date: N/A
```

```bash
:~/Soupedecode01# rustscan -a TargetIP --ulimit 5500 -b 65535 -- -A -Pn
...
PORT      STATE SERVICE       REASON  VERSION
53/tcp    open  domain?       syn-ack
88/tcp    open  kerberos-sec  syn-ack Microsoft Windows Kerberos (server time: 2025-08-01 xx:xx:xx)
135/tcp   open  msrpc         syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn   syn-ack Microsoft Windows netbios-ssn
389/tcp   open  ldap          syn-ack Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds? syn-ack
464/tcp   open  kpasswd5?     syn-ack
593/tcp   open  ncacn_http    syn-ack Microsoft Windows RPC over HTTP 1.0
3268/tcp  open  ldap          syn-ack Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3389/tcp  open  ms-wbt-server syn-ack Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: SOUPEDECODE
|   NetBIOS_Domain_Name: SOUPEDECODE
|   NetBIOS_Computer_Name: DC01
|   DNS_Domain_Name: SOUPEDECODE.LOCAL
|   DNS_Computer_Name: DC01.SOUPEDECODE.LOCAL
|   Product_Version: 10.0.20348
|_  System_Time: 2025-08-01Txx:xx:xx+00:00
| ssl-cert: Subject: commonName=DC01.SOUPEDECODE.LOCAL
| Issuer: commonName=DC01.SOUPEDECODE.LOCAL
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-06-17Txx:xx:xx2
| Not valid after:  2025-12-17Txx:xx:xx
| MD5:   8660 d3bc 0e75 671b 8ffd 9a7e fafb 60b5
| SHA-1: 4349 710e 63b9 e96c 4a8a c557 c8c4 d217 482f 3673
| -----BEGIN CERTIFICATE-----
| MIIC8DCCAdigAwIBAgIQbquejXfqJohC9UQLVBR+cTANBgkqhkiG9w0BAQsFADAh
| MR8wHQYDVQQDExZEQzAxLlNPVVBFREVDT0RFLkxPQ0FMMB4XDTI1MDYxNzIxMzU0
| MloXDTI1MTIxNzIxMzU0MlowITEfMB0GA1UEAxMWREMwMS5TT1VQRURFQ09ERS5M
| T0NBTDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALRjne/Ks+HtZcXt
| BKKUbbTDbTX3AFH72vg8qzFVfmpzCuY6E+nBFUSb7yiQmziAIEWziiRzxh8I6FJ0
| tP3WMdPv1aATe4tAqw9BmlZZu+vcNAMv2ERBAIrWU51dYGBXIuIv/RORbRpvlhdZ
| 9KANtId+bAzFxO/1cl3jrMX512gn1uzz8OrZWH+Bjps6OaZ9qTpu/VWmJTkQIJgM
| LlvMEczaoGzudpCl6i5F3cnGRVU9Lk+sdapL2ILgaZ49EipSj64iUZBi63LyqTJV
| WS81kKzlwg1MS32jFtBRn2e8WPR1NCrB2d6OHGJyCfAlI9C0ViauKHiv6rEMm8tv
| M2pIrNUCAwEAAaMkMCIwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgQw
| MA0GCSqGSIb3DQEBCwUAA4IBAQAnVIHgBDAr9dDRiG4z8D4k2cF+YprxBcWpuvJc
| UvLNF71bezDuD0NwQxJcLV4ocnI/xCakLzG/VUNatbb3QAY0Bv6G3Rpi9Qytrafe
| rED0pe9DsYadx07ci9/FFCI3dq9AhNqLhk+0Z4xOobvhJFkyX1KxGUBp0qnxhw6t
| a0yNa8q4QX1DMNBa3L61VwFEKdHEho02YJ1rH3r/GUXNGhr9dWO5iMOrXmqtucQv
| x0M7qS02MAv3FEEHUk8gb+MlbQHNZmTpuLTJCThgBy1gxxEJ6ovTar8W/topGCKS
| 3JApQpPFWqxW+yWoahcYkGr9q1SKRX1GIq2mXN3NY8A9Rg36
|_-----END CERTIFICATE-----
|_ssl-date: 2025-08-01Txx:xx:xx+00:00; 0s from scanner time.
5985/tcp  open  http          syn-ack Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        syn-ack .NET Message Framing
49664/tcp open  msrpc         syn-ack Microsoft Windows RPC
49667/tcp open  msrpc         syn-ack Microsoft Windows RPC
49676/tcp open  ncacn_http    syn-ack Microsoft Windows RPC over HTTP 1.0
49714/tcp open  msrpc         syn-ack Microsoft Windows RPC
49800/tcp open  msrpc         syn-ack Microsoft Windows RPC
...
Host script results:
|_clock-skew: mean: 0s, deviation: 0s, median: -1s
| nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 16:ff:f9:08:26:3f (unknown)
| Names:
|   DC01<00>             Flags: <unique><active>
|   SOUPEDECODE<00>      Flags: <group><active>
|   SOUPEDECODE<1c>      Flags: <group><active>
|   DC01<20>             Flags: <unique><active>
|   SOUPEDECODE<1b>      Flags: <unique><active>
| Statistics:
|   16 ff f9 08 26 3f 00 00 00 00 00 00 00 00 00 00 00
|   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
|_  00 00 00 00 00 00 00 00 00 00 00 00 00 00
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 32870/tcp): CLEAN (Timeout)
|   Check 2 (port 48849/tcp): CLEAN (Timeout)
|   Check 3 (port 25310/udp): CLEAN (Timeout)
|   Check 4 (port 11923/udp): CLEAN (Timeout)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2025-08-01Txx:xx:xx
|_  start_date: N/A
```

<h3>Enum4linux</h3>

```bash
:~/Soupedecode01# enum4linux TargetIP
... ========================== 
|    Target Information    |
 ========================== 
Target ........... TargetIP
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===================================================== 
|    Enumerating Workgroup/Domain on TargetIP    |
 ===================================================== 
[+] Got domain/workgroup name: SOUPEDECODE

 ============================================= 
|    Nbtstat Information for TargetIP    |
 ============================================= 
Looking up status of 10.201.40.227
	DC01            <00> -         B <ACTIVE>  Workstation Service
	SOUPEDECODE     <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
	SOUPEDECODE     <1c> - <GROUP> B <ACTIVE>  Domain Controllers
	DC01            <20> -         B <ACTIVE>  File Server Service
	SOUPEDECODE     <1b> -         B <ACTIVE>  Domain Master Browser

	MAC Address = 16-FF-F9-08-26-3F

 ====================================== 
|    Session Check on TargetIO    |
 ====================================== 
```

<h3>smbclient</h3>

```bash
```

<h3>/etc/hosts</h3>

```bash
~/Soupedecode01# smbclient -L //TargetIP
Password for [WORKGROUP\root]:

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	backup          Disk      
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	NETLOGON        Disk      Logon server share 
	SYSVOL          Disk      Logon server share 
	Users           Disk      
SMB1 disabled -- no workgroup available
```

