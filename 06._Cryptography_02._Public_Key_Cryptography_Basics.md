<h3> Welcome to the <em>TryHackMe ...</em></h3>
<h1>Cyber Security 101 learning path> Cryptography</h1>
<h2>Public Key Cryptography Basics</h2>
<p>Discover how public key ciphers such as RSA work and explore their role in applications such as SSH.</p>
<p>October 25, 2024<br></p>

<div style="display: flex; justify-content: center; align-items: center;">
    <img src="https://github.com/user-attachments/assets/91186dd8-77f7-447d-8595-b0a1882ef102" width="150px" height="150px"/>
</div>
<br>

![image](https://github.com/user-attachments/assets/50263907-84f7-4727-858c-a74c3fe3f700)

<p>Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m genuinely excited to join you on this adventure.<br>
It´s key part of my <strong><em>172</em></strong>-day-streak.<br>
Let´s get started!!<br><br>
Access this TryHackMe Room clicking <a href="https://tryhackme.com/r/room/publickeycrypto">Public Key Cryptography Basics</a>.</p>

<h2>Task 1 - Introduction</h2>

![image](https://github.com/user-attachments/assets/539a017e-30c6-4aef-aebb-1cdd50cdf4a6)

<p>Consider the following scenario from everyday life. Let’s say you are meeting a business partner over coffee and discussing somewhat confidential business plans. Let’s break down the meeting from the security perspective.<br>

<ul style="list-style-type:square">
    <li>You can see and hear the other person. Consequently, it is easy to be sure of their identity. That’s <code>authentication</code>code>, i.e., you are confirming the identity of who you are talking with.</li>
    <li>You can also confirm that what you are “hearing” is coming from your business partner. You can tell what words and sentences are coming from your business partner and what is coming from others. That’s <code>authenticity</code>, i.e., you verify that the message genuinely comes from a specific sender. Moreover, you know that what they are saying is reaching you, and there is no chance of anything changing the other party’s words across the table. That’s <code>integrity</code>, i.e., ensuring that the data has not been altered or tampered with.</li>
    <li>Finally, you can pick a seat away from the other customers and keep your voice low so that only your business partner can hear you. That’s <code>confidentiality</code>, i.e., only the authorised parties can access the data.</li>
</ul></p>

<br>
Let’s quickly compare this with correspondence in the cyber realm. When someone sends you a text message, how can you be sure they are who they claim to be? How can you be sure that nothing changed the text as it travelled across various network links? When you are communicating with your business partner over an online messaging platform, you need to be sure of the following:<br><br>

<ul style="list-style-type:square">
    <li><code>Authentication</code>: You want to be sure you communicate with the right person, not someone else pretending.</li>
    <li><code>Authenticity</code>: You can verify that the information comes from the claimed source.</li>
    <li><code>Integrity</code>: You must ensure that no one changes the data you exchange</li>
    <li><code>Confidentiality</code>: You want to prevent an unauthorised party from eavesdropping on your conversations.</li>
</ul></p>

<p>Cryptography can provide solutions to satisfy the above requirements, among many others. Private key cryptography, i.e., symmetric encryption, mainly protects confidentiality. However, public key cryptography, i.e., asymmetric cryptography, plays a significant role in authentication, authenticity, and integrity. This room will show various examples of how public key cryptography achieves that.</p>

<h3>Learning Prerequisites</h3>
<p>This room is the second of three introductory rooms about cryptography. Before starting this room, ensure you have finished the first one on the list.</p>
<ul style="list-style-type:square">
    <li><a href="https://tryhackme.com/r/room/cryptographybasics">Cryptography Basics</a></li>
    <li>Public Key Cryptography Basics (this room)</li>
    <li><a href="https://tryhackme.com/r/room/hashingbasics">Hashing Basics</a></li>
</ul>

<h3>Learning Objectives</h3>
<p>In this room, we will cover various asymmetric cryptosystems and applications that use them, such as:</p>
<ul style="list-style-type:square">
    <li>RSA</li>
    <li>Diffie-Hellman</li>
    <li>SSH</li>
    <li>SSL/TLS Certificates</li>
    <li>PGP and GPG</li>
</ul>

<p>First, let’s start the <code>Virtual Machine</code> by pressing the <code>Start Machine</code> button below.</p>

![image](https://github.com/user-attachments/assets/ca86d15e-a4d4-4015-8597-22bb6fa5cf3c)

<p>The machine will start in <code>Split-Screen</code> view. In case the VM is not visible, use the blue <code>Show Split View</code> button at the top of the page.<br>

You can also access the virtual machine using SSH at the IP address <code>10.10.106.141</code> using the following credentials:</p>
<ul style="list-style-type:square">
    <li>Username: user</li>
    <li>Password: Tryhackme123!</li>
</ul>

<pre><code>$ ssh user@10.10.106.141
The authenticity of host '10.10.106.141 (10.10.106.141)' can't be established.
ECDSA key fingerprint is SHA256:BuqwmbgfAS4uiRO/eEZW7Y4/phwugnQahapCGN42ZjE.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.10.106.141' (ECDSA) to the list of known hosts.
user@10.10.106.141's password: 
Welcome to Ubuntu 24.04.1 LTS (GNU/Linux 6.8.0-1016-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Fri Oct 25 20:16:29 UTC 2024

  System load:  0.0                Temperature:           -273.1 C
  Usage of /:   29.6% of 14.47GB   Processes:             98
  Memory usage: 11%                Users logged in:       0
  Swap usage:   0%                 IPv4 address for ens5: 10.10.106.141

 * Ubuntu Pro delivers the most comprehensive open source security and
   compliance features.

   https://ubuntu.com/aws/pro

Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update

Last login: Fri Oct 25 19:12:03 2024 from 10.100.1.175
user@ip-10-10-106-141:~$ 
</code></pre>


> 1.1 - <em>Let´s begin!</em><br>
>> <strong>No answer needed</strong><br>
<p><br></p>

<h2>Task 2 - RSA</h2>
<p>RSA is a public-key encryption algorithm that enables secure data transmission over insecure channels. With an insecure channel, we expect adversaries to eavesdrop on it.</p>

<h3>The Math That Makes RSA Secure</h3>
<p>RSA is based on the mathematically difficult problem of factoring a large number. Multiplying two large prime numbers is a straightforward operation; however, finding the factors of a huge number takes much more computing power.<br>

It’s simple to multiply two prime numbers together even on paper, say 113 × 127 = 14351. Even for larger prime numbers, it would still be a feasible job, even by hand. Consider the following numeric example:</p>
<ul style="list-style-type:square">
    <li>Prime number 1: 982451653031</li>
    <li>Prime number 2: 169743212279!</li>
    <li>Their product: 982451653031 × 169743212279 = 166764499494295486767649</li>
</ul>

<p>On the other hand, it’s pretty tricky to determine what two prime numbers multiply together to make 14351 and even more challenging to find the factors of 166764499494295486767649.<br>

In real-world examples, the prime numbers would be much bigger than the ones in this example. A computer can easily factorise 166764499494295486767649; however, it cannot factorise a number with more than 600 digits. And you would agree that the multiplication of the two huge prime numbers, each around 300 digits, would be easier than the factorisation of their product.</p>

<h3>Numerical Example</h3>
<p>Let’s revisit encryption, decryption, and key usage in asymmetric encryption. The public key is known to all correspondents and is used for encryption, while the private key is protected and used for decryption, as shown in the figure below.</p>

![image](https://github.com/user-attachments/assets/0bcd57d8-becc-4003-a07e-7d433c2575df)

<p>In the <a href="https://tryhackme.com/r/room/cryptographybasics">Cryptography Basics</a> room, we explained the modulo operation and said it plays a significant role in cryptography. In the following simplified numerical example, we see the RSA algorithm in action:</p>
<ol type="1.  ">
  <li>Bob chooses two prime numbers: p = 157 and q = 199. He calculates n = p × q = 31243.</li>
  <li>With ϕ(n) = n − p − q + 1 = 31243 − 157 − 199 + 1 = 30888, Bob selects e = 163 such that e is relatively prime to ϕ(n); moreover, he selects d = 379, where e × d = 1 mod ϕ(n), i.e., e × d = 163 × 379 = 61777 and 61777 mod 30888 = 1. The public key is (n,e), i.e., (31243,163) and the private key is $(n,d), i.e., (31243,379).</li>
  <li>Let’s say that the value they want to encrypt is x = 13, then Alice would calculate and send y = xe mod n = 13163 mod 31243 = 16342.</li>
  <li>Bob will decrypt the received value by calculating x = yd mod n = 16341379 mod 31243 = 13. This way, Bob recovers the value that Alice sent.</li>
</ol></p>
<p>The proof that the above algorithm works can be found in <a href="https://www.britannica.com/science/modular-arithmetic">modular arithmetic</a> and is beyond the scope of this module. It is worth repeating that in this example, we picked a three-digit prime number, while in an actual application, p and q would be at least a 300-digit prime number each.</p>

<h3>RSA in CTFs</h3>
<p>The math behind RSA comes up relatively often in CTFs, requiring you to calculate variables or break some encryption based on them. Many good articles online explain RSA, and they will give you almost all of the information you need to complete the challenges. One good example of an RSA CTF challenge is the <a href="https://tryhackme.com/r/room/breakrsa">Breaking RSA</a> room.

There are some excellent tools for defeating RSA challenges in CTFs. My favourite is <a href="https://github.com/RsaCtfTool/RsaCtfTool">RsaCtfTool</a>, which has worked well for me. I’ve also had some success with <a href="https://github.com/ius/rsatool">rsatool</a>.

You need to know the main variables for RSA in CTFs: p, q, m, n, e, d, and c. As per our numerical example:</p>
<ul style="list-style-type:square">
    <li><code>p</code> and <code>q</code> are large prime numbers</li>
    <li><code>n</code> is the product of <code>p</code> and <code>q</code></li>
    <li>The public key is <code>n</code> and <code>e</code></li>
    <li>The private key is <code>n</code> and <code>d</code></li>
    <li><code>m</code> is used to represent the original message, i.e., plaintext</li>
    <li><code>c</code> represents the encrypted text, i.e., ciphertext</li>
</ul>

<p>Crypto CTF challenges often present you with a set of these values, and you need to break the encryption and decrypt a message to retrieve the flag.</p>

> 3.1 - <em>Knowing that p = 4391 and q = 6659. What is n?</em><br>
>> <strong>29239669</strong><br>
<p></p>

![image](https://github.com/user-attachments/assets/817e6bbe-5e05-4768-a72c-b293488ea1ed)

> 3.2 - <em>Knowing that p = 4391 and q = 6659. What is ϕ(n)?</em><br>
>> <strong>29228620</strong><br>
<p></p>

![image](https://github.com/user-attachments/assets/f0a4c303-f1fa-4c6e-a048-64b0b9bd4fdf)

<h2>Task 4 - Diffie-Hellman Key Exchange</h2>
<p>One of the challenges of using symmetric encryption is sharing the secret key. Let’s say you want to send a password-protected document to your business partner to discuss confidential business strategies. How would you share the password with them? It would be best if you had a secure channel to send the password, knowing that adversaries cannot read or alter it.</p>

<h3>Diffie-Hellman Key Exchange</h3>
<p><strong>Key exchange</strong> aims to establish a shared secret between two parties. It is a method that allows two parties to establish a shared secret over an insecure communication channel without requiring a pre-existing shared secret and without an observer being able to get this key. Consequently, this shared key can be used for symmetric encryption in subsequent communications.<br>

Consider the following scenario. Alice and Bob want to talk securely. They want to establish a shared key for symmetric cryptography but don’t want to use asymmetric cryptography for the key exchange. This is where the Diffie-Hellman Key Exchange comes in.<br>

Alice and Bob generate secrets independently; let’s call these secrets A and B. They also have some public common material; let’s call this C.<br>

We need to make some assumptions. Firstly, whenever we combine secrets, they’re practically impossible to separate. Secondly, the order in which they’re combined doesn’t matter. Alice and Bob will combine their secrets with the common material to form AC and BC. They will then send these to each other and combine the received part with their secret to create two identical keys, both ABC. Now, they can use this key to communicate.<br>

If you found the previous paragraphs too abstract, let’s investigate the exact process.</p>
<p> .... working .....</p>


![image](https://github.com/user-attachments/assets/7a8cf30c-a8bf-4f3d-b063-028cbed78f6f)

<p>The chosen numbers are too small to provide any security, and in real-life applications, we would consider much bigger numbers.<br>

Diffie-Hellman Key Exchange is often used alongside RSA public key cryptography. Diffie-Hellman is used for key agreement, while RSA is used for digital signatures, key transport, and authentication, among many others. For instance, RSA helps prove the identity of the person you’re talking to via digital signing, as you can confirm based on their public key. This would prevent someone from attacking the connection with a man-in-the-middle attack against Alice by pretending to be Bob. In brief, Diffie-Hellman and RSA are incorporated into many security protocols and standards to provide a comprehensive security solution.</p>

> 4.1 - <em>Consider p = 29, g = 5, a = 12. What is A?</em><br>
>> <strong>7</strong><br>
<p></p>

![image](https://github.com/user-attachments/assets/a0d78bf2-c427-4bc1-ba84-ee24643397d7)

> 4.2 - <em>Consider p = 29, g = 5, b = 17. What is B?</em><br>
>> <strong>9</strong><br>
<p></p>

![image](https://github.com/user-attachments/assets/7dcebc8d-f07b-40f8-af62-9a01b533a1e8)


> 4.3 - <em>Knowing that p = 29, a = 12, and you have B from the second question, what is the key calculated by Bob? (key = Ba mod p)</em><br>
>> <strong>24</strong><br>
<p></p>

![image](https://github.com/user-attachments/assets/d54b31ee-cc27-4011-9a6f-dac10b6ef4d0)


> 4.4 - <em>Knowing that p = 29, b = 17, and you have A from the first question, what is the key calculated by Alice? (key = Ab mod p)</em><br>
>> <strong>24</strong><br>
<p></p>

![image](https://github.com/user-attachments/assets/8c9b3b77-b448-454a-a527-c770893bf1a7)


<h2>Task 5 - SSH</h2>

> 5.1 - <em>Check the SSH Private Key in <code>~/Public-Crypto-Basics/Task-5</code>. What algorithm does the key use?</em><br>
>> <strong>RSA</strong><br>
<p></p>

<h2>Task 6 - Digital Signatures and Certificates</h2>

> 6.1 - <em>What does a remote web server use to prove itself to the client?</em><br>
>> <strong>29228620</strong><br>
<p></p>

> 6.2 - <em>What would you use to get a free TLS certificate for your website?</em><br>
>> <strong>29228620</strong><br>
<p></p>

<h2>Task 7 - PGP and GPG</h2>

> 7.1 - <em>Use GPG to decrypt the message in <code>~/Public-Crypto-Basics/Task-7</code>. What secret word does the message hold?</em><br>
>> <strong>29228620</strong><br>
<p></p>

<h2>Task 8 - Conclusion</h2>
<p>We have defined <code>cryptography</code> as the science of securing communication in the presence of adversaries. Another important science that studies how to break or bypass cryptographic systems is <code>cryptanalysis</code>. As for trying every possible password combination, we call that a <code>brute-force attack</code>. However, when we know that the password is most likely a dictionary word, it will make more sense to try words from a dictionary instead of every possible password combination; this is called a <code>dictionary</code> attack.</p>
<ul style="list-style-type:square">
    <li><code>Cryptography</code> is the science of securing communication and data using codes and ciphers.</li>
    <li><code>Cryptanalysis</code> is the study of methods to break or bypass cryptographic security systems without knowing the key.: You can verify that the information comes from the claimed source.</li>
    <li><code>Brute-Force Attack</code> is an attack method that involves trying every possible key or password to decrypt a message.</li>
    <li><code>Dictionary Attack</code>: is an attack method where the attacker tries dictionary words or combinations of them.</li>
</ul></p>

<p>This room focused on public key cryptography, asymmetric cryptography, and key exchange. It gave you an essential understanding of RSA, Diffie-Hellman, SSH key pairs, digital signatures and certificates, and OpenPGP. Now, it is time to learn about hashing.</p>


> 8.1 - <em>Ensure you have noted the various techniques and tools discussed in this room.</em><br>
>> <strong>No answer needed</strong>
<p></p>

<h2>Room Complete</h2>
<p>Keep learning, keep growing!<br>

<p>INSERIR IMAGEM</p>


<h2>My journey</h2>
<p></p>Following I share the status of my journey in TryHackMe.</p>

<p>INSERIR IMAGEM</p>

<p></p>

<p style="text-align: center;">Thank you for coming. Hope to learn together again!!</p>
