<h1 align="center">Mobile Malware Analysis</h1>
<p align="center">2025, August 14<br> Hey there, fellow lifelong learner! I´m <a href="https://www.linkedin.com/in/rosanafssantos/">Rosana</a>, and I’m excited to join you on this adventure, part of my <code>465</code>-day-streak in <a href="https://tryhackme.com">TryHackMe</a>.<br>
<em>Learn and practice mobile malware analysis.</em><br>
<img width="80px" src="https://github.com/user-attachments/assets/2124fc4d-d59f-40dc-8683-abed9799abf5"><br>
Access this TryHackMe´s walkthrough <a href="https://tryhackme.com/room/mma">here </a>.<br>
<img width="1200px" src=""></p>

<br>

<h2>Task 1 . Introduction</h2>
<p>It's incredible how often our computers are in the scope of cyber attacks. Antivirus has become an indispensable shield to provide us with a more secure environment, since we are exposed to destructible malware and cyber attacks. Inside our pockets, we have computers so powerful, but much smaller, we must be equally attentive on our phones, because we can suffer equally damaging attacks, sometimes even worse, because they can store relevant information such as private conversations and important accounts.</p>
<p>Content Security Policy, or CSP, is a policy usually sent via an HTTP response header from the webserver to your browser when requesting a page that describes which sources of content the browser should allow to be loaded in, and which ones should be blocked. In case an XSS or data injection vulnerability is found in a website, CSP is designed to prevent this vulnerability from being exploited until it's properly patched, and should serve as an extra layer of protection, not as your only line of defense. <br>

<p><em>Answer the question below</em></p>

<p>1.1. Read the text above.<br>
<code>Content Security Policy</code></p>

<br>
<br>
<h2>Task 2 . An Unknown Land</h2>
<p>It is important to look at the past to understand why things are as they are today.<br><br>
A new technology, due to the lack of exploration, appears to be extremely reliable.<br><br>
Every system is reliable, until someone proves otherwise.<br><br>
You will need to do some research in order to answer the questions in this task.</p>

<p><em>Answer the questions below</em></p>

<p>2.1. What known as the first malware created to affect mobile devices?<br>
<code>Cabir</code></p>

<br>

<p>2.2. What technology does this worm used to multiply?<br>
<code>Bluetooth</code></p>

<br>

<p>2.3. What operating system did it infect?<br>
<code>Symbian</code></p>

<br>

<p>2.4. What message did it show on the screen of the infected mobile phone?<br>
<code>Caribe</code></p>

<br>

<p>2.5. The worm was created and sent out by researchers as a PoC (Proof of Concept), they did not believe that the mobile operating system could be easily exploited. Since then, malicious programs have become more popular. <br>
<code>No answer needed</code></p>

<br>
<br>
<h2>Task 3 . Small size, a lot of destruction.</h2>
<p>There is a weird file inside this machine, it looks malicious, but let's not jump into conclusions.<br><br>

Deploy the machine in this task and wait for the connection to the machine to be made in your browser.</p>

<p>You can also c align="center"onnect to the TryHackMe VPN & use an RDP client of your choice using the following credentials:<br><br>

Username: ***<br><br>

Password: ******************</p>

<br>

<p align="center"><img width="700px" src="https://github.com/user-attachments/assets/a84e7417-9f86-4f43-af87-8aacd2014416"></p>

<br>

<p align="center">You can open this view in full-screen by pressing the two diagonal arrows at the bottom right.</p>

<br>

<p>Wait for the MobSF application to load (this may take a few minutes, but the process is automatic so please just be patient) and you will find the files you should analyse on the machines Desktop.</p>


<h6align="center"><img width="700px" src="https://github.com/user-attachments/assets/a84e7417-9f86-4f43-af87-8aacd2014416"><br><br><em>This view means that MobSF is ready to be used.</em></h6>

<p><em>Answer the questions below</em></p>

<p>3.1. Deploy the machine & use MobSF to scan the file named "TWFsd2FyZQ.apk" that is located on the Desktop.<br>
<code>No answer needed</code></p>

<br>

<p>3.2. What is the format of the file?<br>
<code>____________________________</code></p>


<br>

<p>3.3. The sample's size is 10,1 bytes, so it seems that it is not a complex application.<br>
<code>No answer needed</code></p>


<br>

<p>3.4. Decode the name of the sample. Hint : Check to see what encoding the name of the file is<br>
<code>____________________________</code></p>


<br>

<p>3.5. Which is the target platform?<br>
<code>____________________________</code></p>


<br>
<br>
<h2>Task 4 . Digging Deeper</h2>
<p>Let's make a deeper analysis.<br><br>

VirusTotal is a incredible service, this web site can give us the power of analyze a package with the database of more then seventy Anti-Virus, and the result is fast and accurate.<br><br>

https://www.virustotal.com/<br><br>

To analyze the file in VirusTotal, you will need the file hash, you can get it by using the powershell cmdlet "Get-FileHash" or you can analyze the filw with MobSF and it will show the file hash (we will get back to this tool in the next task).</p>

<p><em>Answer the questions below</em></p>

<p>4.1. What does Avast-Mobile can tell us about this software? Hint : Use VirusTotal to check the file.<br>
<code>____________________________</code></p>

<br>

<p>4.2. What program was used to create the malware?<br>
<code>____________________________</code></p>


<br>

<p>4.3.The results provided by VirusTotal shows that we have a generic malware. It does not serve for attack purposes because we can see that a good part of the Antiviruses are detecting it, this malware is a good one for searching purposes, but it is also used for post exploitation.<br>
<code>No answer needed</code></p>


<br>

<p>4.4. What is the package name?<br>
<code>____________________________</code></p>


<br>

<p>4.5.What is the SHA-1 signature?<br>
<code>____________________________</code></p>


<br>

<p>4.6. By extracting the content, it will create a folder with some files inside, one of which is a XML. It describes some important information about the application for Android build tools, for Android operating system and for Google Play. This file declares items, shows some stuff as the package name and the permissions required to the device. The information that will be needed for the next questions can be found on VirusTotal also.<br>
<code>No answer needed</code></p>


<br>

<p>4.7. What is the unique XML file?<br>
<code>____________________________</code></p>


<br>

<p>4.8. How many permissions are there inside?<br>
<code>____________________________</code></p>


<br>

<p>4.9. Which permission allows the application to take pictures with the camera?<br>
<code>____________________________</code></p>

<br>

<p>4.10. What is the message left by the community?<br>
<code>____________________________</code></p>


<br>
<br>
<h2>Task 5 . MobSFing the sample</h2>
<p>Let's use MobSF(Mobile Security Framework) to make a deeper analysis of this file, MobSF is a software created to make a security focused analysis of Android and IOS files. It can check for misconfigurations, leaked data and much more in a mobile program.<br><br>

This tool can be used for static and dinamic analysis, in this room we will focus only in the static analysis but you are free to install it in a virtual machine you own to understand more how the application works, you can install it in GitHub - https://github.com/MobSF/Mobile-Security-Framework-MobSF.<br><br>

The machine is configured to start MobSF when deployed, if you accidentally closed the web page you can visit the MobSF page by visiting the link http://127.0.0.1:8000 inside the deployed machine. Press the "Upload & Analyze" button and select the file we have been working on.
</p>

<p><em>Answer the questions below</em></p>

<p>5.1. What is the programming language used to create the program?<br>
<code>____________________________</code></p>


<br>

<p>5.2. How many signatures does the package has?<br>
<code>____________________________</code></p>

<br>

<p>5.3. Application is signed with v1 signature scheme, what is it vulnerable to on Android <7.0?<br>
<code>____________________________</code></p>


<br>

<p>5.4. MobSF gives all the code decompiled. Just a base of programming make us able to understand a little bit of what is happening.<br>
<code>No answer needed</code></p>

<br>


<p>5.5. This malware is used to create a connection with the victim that is called a reverse shell.<br>
<code>No answer needed</code></p>

<br>

<p>5.6. What is the App name?<br>
<code>____________________________</code></p>

<br>

<p>5.7. It looks like  there is a function calling for the package manager, so it can see all the installed applications. What function is that? Hint : Payload.java shows the answer.<br>
<code>____________________________</code></p>

<br>

<p>5.8. Returning to the manifest. The flag "android:allowBackup" allows the user to backup application data via USB debugging. It is recommended that this be set as "False", even if by default it is "True". What is the severity of this configuration?<br>
<code>____________________________</code></p>


<br>
<br>
<h2>Task 6 . It doesn´t smell good!</h2>
<p>I think that now we have the necessary knowledge to analyze bigger stuff.<br><br>

Our next sample located on the Desktop, the name of the file is sample2.apk, let's start a MobSF analysis on it.</p>

<p><em>Answer the questions below</em></p>

<p>6.1. What is the SHA-256 hash of the file?<br>
<code>____________________________</code></p>

<br>

<p>6.2. After finding the sample on VirusTotal, what does the "Avast" anti-virus engine recognizes it as?<br>
<code>____________________________</code></p>

<br>

<p>6.3. With what we have, try to find out the name of the sample.<br>
<code>____________________________</code></p>

<br>

<p>6.4. It seems like it is a very dangerous malware and has a big history of destruction. This became news for spying journalists, what year was that? Hint : You will need to do some research. It is very interesting.<br>
<code>____________________________</code></p>

<br>

<p>6.5. It was reported that the malware was developed by a legitimate intention:  The idea behind it was to use the software as a government tool designed to  track and combat terrorism and crime.
This malware has been found infecting people's smartphones and political activists in more than 44 countries.<br>
<code>No answer needed</code></p>

<br>

<p>6.6. If we search the name we found of the malware in MITRE ATT&CK (https://attack.mitre.org/), we can find some interesting information. What is the ID of the MITRE ATT&CK that is associated with our sample?.<br>
<code>____________________________</code></p>

<br>

<p>6.7. What technique has the ability to exploit OS vulnerabilities to escalate privileges? Hint : MITRE ATT&CK, Techniques Used.<br>
<code>____________________________</code></p>


<br>

<p>6.8. Now, let's go back to the MobSF analysis.<br>
<code>No answer needed</code></p>

<br>

<p>6.9. There is a permission that when accepted, allows the application to access the list of accounts in the Accounts Service. What is the status shown by MobSF regarding this permission. (android.permission.GET.ACCOUNTS)<br>
<code>____________________________</code></p>


<br>

<p>6.10. What org.eclipse.paho.client file refers to properties of Portuguese from Brazil (pt-br)? Hint : The answer can be found at the bottom of the analysis page. Hint : The answer can be found at the bottom of the analysis page<br>
<code>____________________________</code></p>

<br>

<p>6.11. This software has several features that make the identification and the processes it performs to explore the target, harder to handle, even when it is being analyzed.<br>
<code>____________________________</code></p>

<br>

<p>6.12. The malware has a special appeal for its safety and its internal components, reducing the risk of compromise. It has a functionality for its cryptographic operations with the feature of a random bit generation service. How can it be identified? Hint : NIAP ANALYSIS<br>
<code>____________________________</code></p>

<br>
<br>
<h2>Task 7 . Conclusion</h2>
<p>It is normal to think that our mobile phones are harder to be infected, they have characteristics that makes th<br><br>

Here I leave some awesome articles and other rooms that may be interesting to get deeper into this subject.<br><br>

https://github.com/OWASP/owasp-mstg<br>
https://attack.mitre.org/matrices/mobile/android/<br>
https://attack.mitre.org/matrices/mobile/ios/<br><br>

https://tryhackme.com/room/malmalintroductory<br>
https://tryhackme.com/room/androidhacking101<br>
https://tryhackme.com/room/iosforensics<br><br>

If you have any feedback, feel free to contact me on discord: farinap5#4535</p>

<p><em>Answer the question below</em></p>

<p>7.1. Thank you for your participation!<br>
<code>No answer needed</code></p>

<br>

